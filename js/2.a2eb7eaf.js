(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"10b3":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"purchasesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=dealer",table:"purchases",title:"รายการซื้อสินค้า",classes:t.settings.classes,columns:t.purchaseColumns,onInitAddData:t.onInitAddDataPurchases,onValidateData:t.onValidateDataPurchases,onAfterLoadData:t.onAfterLoadDataPurchases,onBeforeUpdateData:t.onBeforeUpdateDataPurchases,onBeforeRemoveData:t.onBeforeRemoveDataPurchases,onAfterRemoveData:t.onAfterRemoveDataPurchases}}),a("JsonTable",{ref:"purchaseProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:t.query,table:"purchaseProducts",title:t.title,classes:t.settings.classes,columns:t.purchaseProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onBeforeLoadData:t.onBeforeLoadData,onAfterLoadData:t.onAfterLoadData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData,onBeforeRemoveData:t.onBeforeRemoveData,onAfterRemoveData:t.onAfterRemoveData,rowsPerPage:0,showEditDialog:t.showEditDialog,hidePagination:""}}),a("q-page-sticky",{staticClass:"z-top",attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:Object.keys(t.purchaseRow).length<=0||(+t.purchaseRow.net||0)<=0},on:{click:function(){return t.printData()}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[Object.keys(t.purchaseRow).length>0?a("div",{staticClass:"q-pa-none row wrap justify-center items-start content-start",staticStyle:{width:"780px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-none text-bold",staticStyle:{width:"722px","font-size":"larger"}},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            "+t._s(t.purchaseRow.dealer.name||"ผู้จำหน่าย")+"\n          ")]),t.purchaseRow.dealer.address?a("div",[t._v("\n            "+t._s(t.purchaseRow.dealer.address)+"\n          ")]):t._e(),t.purchaseRow.dealer.telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s(t.purchaseRow.dealer.telephone)+"\n          ")]):t._e(),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลซื้อสินค้า\n          ")]),t.purchaseRow.date?a("div",{attrs:{align:"center"}},[t._v("\n            "+t._s(new Date(t.purchaseRow.date).toLocaleString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))+" น.\n          ")]):t._e()]),t.settings?a("div",{attrs:{align:"left"}},[t.settings.name?a("div",[t._v("\n            นาม: "+t._s(t.settings.name)+"\n          ")]):t._e(),t.settings.address?a("div",[t._v("\n            ที่อยู่: "+t._s(t.settings.address)+"\n          ")]):t._e(),t.settings.telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s(t.settings.telephone)+"\n          ")]):t._e()]):t._e(),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l((t.$refs.purchaseProductsRef||{}).data,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-right"},[t._v(t._s(e.quantity)+"\n              ")]),a("div",{staticClass:"q-px-xs col",staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[t._v(t._s(e.product.name))]),a("div",{staticClass:"col-2 text-right"},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.purchaseProductsRef||{}).data||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" หน่วย")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.purchaseProductsRef||{}).data||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col-7"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.purchaseRow.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]),t.purchaseRow.discount?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.purchaseRow.discount||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.purchaseRow.vat?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.purchaseRow.total>0?(+t.purchaseRow.total-+t.purchaseRow.discount)*+t.purchaseRow.vat/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s((+t.purchaseRow.net||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])])])])]),t._m(1)])]):t._e()])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1 text-center"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-2 text-center"},[t._v("ราคา")]),a("div",{staticClass:"col-3 text-center"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("4160"),a("caad"),a("13d5"),a("b0c0"),a("b680"),a("cca6"),a("b64b"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ec67")),o=a("1732"),r={name:"PagePurchases",data:function(){return{purchaseColumns:[{name:"id",label:"รหัสซื้อ",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"dealerId",label:"ผู้จำหน่าย",field:"dealerId",sortable:!0,classes:"text-green-10 text-left",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:"net",sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],purchaseProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return t.product.id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product.type||{name:void 0}).name},sortable:!0,classes:"text-left",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product.unit||{name:void 0}).name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,classes:"text-left",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคา",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"product.cost",label:"ราคาทุน",field:function(t){return t.product.cost},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"total",label:"ราคารวม",field:"total",sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.price",label:"ราคาขาย",field:function(t){return t.product.price},sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"product.quantity",label:"คงเหลือ",field:function(t){return t.product.quantity},sortable:!0,classes:"text-weight-bold",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],query:"_expand=product&_expand=type&_expand=unit&purchaseId=".concat(void 0),title:"ซื้อสินค้า",purchaseRow:{},isRequireLoadDataPurchases:!1,isRequireLoadDataPurchaseProducts:!1,showEditDialog:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("purchases")?this.$global.data.panelModel===this.$options.name?this.$refs.purchasesRef.onRequest():this.isRequireLoadDataPurchases||(this.isRequireLoadDataPurchases=!0):t.request.path.split("/").includes("purchaseProducts")&&(this.$global.data.panelModel===this.$options.name?this.$refs.purchaseProductsRef.onRequest():this.isRequireLoadDataPurchaseProducts||(this.isRequireLoadDataPurchaseProducts=!0)))},"$global.data.panelModel":function(t,e){t===this.$options.name&&(this.isRequireLoadDataPurchases&&(this.isRequireLoadDataPurchases=!1,this.$refs.purchasesRef.onRequest()),this.isRequireLoadDataPurchaseProducts&&(this.isRequireLoadDataPurchaseProducts=!1,this.$refs.purchaseProductsRef.onRequest()))}},methods:{onInitAddDataPurchases:function(t){t.date=(new Date).toISOString(),t.vat=this.settings.vatPurchase,t.dealerId=+this.purchaseRow.dealerId||0,t.dealer=this.purchaseRow.dealer},onValidateDataPurchases:function(t,e,a,s){return"dealerId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลผู้จำหน่าย":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onAfterLoadDataPurchases:function(t,e){1===e.length?(this.purchaseRow=e[0],this.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(this.purchaseRow.id),this.title="ซื้อสินค้า ".concat((e[0].dealer||{}).name," [").concat(this.purchaseRow.id,"] (").concat(new Date(e[0].date).toLocaleString(),")"),this.$global.scrollToElement("scrollToThis",1e3,1e3)):(this.purchaseRow={},this.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(this.purchaseRow.id),this.title="ซื้อสินค้า"),document.activeElement.blur()},onBeforeUpdateDataPurchases:function(t,e){e.id||(e.date=(new Date).toISOString()),e.net=+e.total-+e.discount,e.net=e.net+e.net*+e.vat/100,e.net=+e.net.toFixed(this.settings.fractionDigits)},onBeforeRemoveDataPurchases:function(t,e){console.log("Event onBeforeRemoveDataPurchases")},onAfterRemoveDataPurchases:function(t,e,a){var s=this;a&&a.__deleted__&&a.__deleted__.purchaseProducts&&a.__deleted__.purchaseProducts.forEach((function(t){s.updateProduct({productId:t.productId,quantity:0,__:{quantity:t.quantity}})}))},onInitAddData:function(t){if(!this.purchaseRow.id)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t),t.quantity=this.settings.quantityPurchase},onInitEditData:function(t){if(!this.purchaseRow.id)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t)},onValidateData:function(t,e,a,s){return"productId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===e.name&&t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onBeforeLoadData:function(t,e){var a=this;e.forEach((function(t){return a.initialData(t)}))},onAfterLoadData:function(t,e){this.onAfterLoadData.productItem&&(this.addProductItem(this.onAfterLoadData.productItem),delete this.onAfterLoadData.productItem),document.activeElement.blur()},onBeforeUpdateData:function(t,e){e.purchaseId||(e.purchaseId=this.purchaseId),e["product.cost"]=+(+e.price-+e.discount).toFixed(this.settings.fractionDigits),e.total=+(+e.quantity*+e["product.cost"]).toFixed(this.settings.fractionDigits),e["product.price"]||(e["product.price"]=Math.round(e["product.cost"]+e["product.cost"]*this.settings.profit/100))},onAfterUpdateData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},onBeforeRemoveData:function(t,e){e.__.quantity=e.quantity,e.quantity=0},onAfterRemoveData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},initialData:function(t){t.purchaseId||(t.purchaseId=this.purchaseRow.id),t.__=Object.assign({},t.__,{quantity:t.quantity})},updateTotal:function(t){var e=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/purchaseProducts?purchaseId=").concat(this.purchaseRow.id),{params:{uid:this.UID}}).then((function(a){if(Object.keys(e.purchaseRow).length>0){var s={total:+a.data.reduce((function(t,e){return t+e.total}),0).toFixed(e.settings.fractionDigits)};s.net=s.total-+e.purchaseRow.discount,s.net=s.net+s.net*+e.purchaseRow.vat/100,s.net=+s.net.toFixed(e.settings.fractionDigits),e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/purchases/").concat(e.purchaseRow.id),s,{params:{uid:e.UID}}).then((function(a){e.purchaseRow.total=a.data.total,e.purchaseRow.net=a.data.net,t.__.quantity=t.quantity,e.$emit("update-cell","purchases",a.data,s)})).catch((function(t){}))}else e.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(e.purchaseRow.id),e.title="ซื้อสินค้า"})).catch((function(t){}))},updateProduct:function(t){var e=this,a={id:t.productId,quantityDelta:+t.quantity-+t.__.quantity};t["product.cost"]&&(a.cost=+t["product.cost"].toFixed(this.settings.fractionDigits)),t["product.price"]&&(a.price=+t["product.price"].toFixed(this.settings.fractionDigits)),this.$jsonFetch.patch("".concat(this.$global.data.baseUrl,"/products/").concat(t.productId),a,{params:{uid:this.UID}}).then((function(s){t.product=Object.assign({},s.data),e.$emit("update-cell","products",s.data,a)})).catch((function(t){}))},updateCash:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.cashDialog=!1,t.cash=this.cashValue;var s={id:t.id,cash:t.cash};this.$jsonFetch.patch("".concat(this.$global.data.baseUrl,"/purchases/").concat(t.id),s,{params:{uid:this.UID}}).then((function(t){a&&(e.printBorderVisibility(!1),e.$global.print("#print",e.settings.name,(function(){return e.printBorderVisibility(!0)}))),e.$emit("update-cell","purchases",t.data,s)})).catch((function(t){}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},printData:function(){var t=this;Object.keys(this.purchaseRow).length>0?(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return t.printBorderVisibility(!0)}))):(this.cashDialog=!0,this.cashValue=0)},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"}}},l=r,c=a("2877"),d=a("de5e"),u=a("9c40"),p=a("eebe"),f=a.n(p),h=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=h.exports;f()(h,"components",{QPageSticky:d["a"],QBtn:u["a"]})},"3eb8":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"settingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"ประมวลผลข้อมูล","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:(t.$global.data.settings||{}).classes,columns:t.summaryColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}}),a("h1",{staticClass:"text-center text-primary"},[t._v("Comming Soon")]),a("h1",{staticClass:"text-center text-secondary"},[t._v("ประมวลผลข้อมูล")])],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("38cf"),a("1276"),a("ec67")),o=a("1732"),r={name:"PageSummary",data:function(){return{summaryColumns:[{name:"id",label:"รหัสกิจการ",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อกิจการ",field:"name",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-center",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"password",label:"รหัสผ่าน",field:function(t){return"•".repeat((t.password||"").length)},sortable:!1,classes:"text-green-10 text-center",edit:{type:"password",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataSettings:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("settings")&&(this.$global.data.panelModel===this.$options.name?(this.$refs.settingsRef.onRequest(),t.response.body&&this.updateHandler("",t.response.body)):this.isRequireLoadDataSettings||(this.isRequireLoadDataSettings=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataSettings&&(this.isRequireLoadDataSettings=!1,this.$refs.settingsRef.onRequest())}},methods:{updateHandler:function(t,e){this.$global.data.settings=Object.assign({},this.$global.data.settings,e),"settings"!==t||!e||e.email===this.$global.data.users.name&&e.password===this.$global.data.users.password||this.updateUserToken(e.email,e.password)},updateUserToken:function(t,e){var a=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/jwt/sign?name=").concat(t,"&password=").concat(e)).then((function(s){var i=s.data.token;a.$jsonFetch.get("".concat(a.$global.data.baseUrl,"/__users"),void 0,{params:{name:t}}).then((function(s){s.data.length>0?a.$jsonFetch.patch("".concat(a.$global.data.baseUrl,"/__users/").concat(s.data[0].id),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){})):a.$jsonFetch.post("".concat(a.$global.data.baseUrl,"/__users"),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){}))})).catch((function(t){}))})).catch((function(t){}))}}},l=r,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},"49de":function(t,e,a){"use strict";(function(t){a("99af"),a("caad"),a("e260"),a("a15b"),a("a434"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("1276"),a("ddb0"),a("2b3d");var s=a("278c"),i=a.n(s),n=a("fbb2"),o=a("10b3"),r=a("7d5b"),l=a("5eaa"),c=a("7079"),d=a("caa3"),u=a("3eb8"),p=a("f9ea"),f=["POST","PUT","PATCH","DELETE"],h=100;e["a"]={name:"MainLayout",data:function(){return{table:"settings",isLoaded:!1,menuModel:!1,panelModel:"PageSales",logs:[],showSetJsonServer:!1,showAuthentication:!1,eventDialog:!1,importDialog:!1,exportDialog:!1,exitDialog:!1,baseUrl:"",user:"",password:"",importFile:void 0,dialogPos:{x:0,y:0}}},components:{Sales:n["a"],Purchases:o["a"],Customers:r["a"],Dealers:l["a"],Products:c["a"],PrintBarcode:d["a"],Summary:u["a"],Settings:p["a"]},created:function(){var t=this;this.$on("error",(function(e){t.appendLogs("".concat(e,"\n"))}))},mounted:function(){var t=this;this.$set(this.$global.data,"baseUrl","".concat(localStorage.getItem("baseUrl")||window.location.origin,"/api").replace(/([^:])\/\//g,"$1/")),this.$set(this.$global.data,"users",void 0),this.$set(this.$global.data,"settings",void 0),this.$set(this.$global.data,"images",void 0),this.$set(this.$global.data,"modify",void 0),this.$set(this.$global.data,"panelModel",this.panelModel),this.baseUrl=this.$global.data.baseUrl.replace(/\/api$/,""),this.$jsonFetch.onError=function(e){e.response&&401===e.response.status?setTimeout((function(){t.$q.loading.hide(),t.showAuthentication=!0}),1e3):(console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)}))},console.log("Check Settings"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")},this.$jsonFetch.get("".concat(this.baseUrl)).then((function(e){"OK"===e.data?t.loadSettings():(t.$q.loading.hide(),t.showSetJsonServer=!0)})).catch((function(e){t.$q.loading.hide(),t.showSetJsonServer=!0}))},computed:{settings:{get:function(){return this.$global.data.settings||{}}},images:{get:function(){return this.$global.data.images||{}},set:function(t){this.$global.data.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}},log:function(){return this.logs.join("")}},watch:{panelModel:function(t,e){this.$global.data.panelModel=t}},methods:{setLocalStorageFromFile:function(t,e){var a=this;if(t&&e){var s=new FileReader;s.readAsDataURL(e),s.onload=function(){localStorage.setItem(t,s.result),a.images={logo:localStorage.getItem("logo"),logoColor:localStorage.getItem("logoColor")}}}},refreshPage:function(t){t&&t.length>0&&localStorage.setItem("baseUrl",t),this.$nextTick((function(){return window.location.reload()}))},loadSettings:function(e){var a=this;console.log("Load Settings"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/").concat(this.table,"?_page=1&_sort=id&_order=desc&_limit=1"),void 0,e?{headers:{Authorization:"Basic ".concat(t.from(this.user+":"+this.password).toString("base64"))}}:void 0).then((function(t){t.headers["x-total-count"]>0&&(a.$global.data.settings=t.data.pop()||{}),setTimeout((function(){a.$global.data.users={name:a.settings.email,password:a.settings.password},a.password=void 0,a.$refs.userInputRef&&a.$refs.userInputRef.focus(),a.isLoaded=!0,a.initialWebsocket(),a.$q.loading.hide(),a.showAuthentication=!1}),1e3)})).catch((function(t){a.$q.loading.hide(),t.response&&401!==t.response.status&&(console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}))}))},appendLogs:function(t){this.logs.length>=h&&this.logs.splice(-1,1),this.logs.splice(0,0,"[".concat((new Date).toLocaleString(),"] ").concat(t))},initialWebsocket:function(){this.$wsClient.open("".concat(this.$global.data.baseUrl.replace(/^http/,"ws"))),this.$wsClient.onmessage=function(t,e){var a=JSON.parse(t.data||"{}");if("LOG"===a.type||"ERROR"===a.type)this.appendLogs(a.data);else if(f.includes(a.request.method)){var s=a.request.path.split("/"),n=i()(s,3),o=n[1],r=n[2];"api"!==o&&(r=o),"db"===r?this.refreshPage():("settings"===r&&(this.$global.data.settings=a.response.body||{}),this.$global.data.modify={request:a.request,response:a.response})}}.bind(this)},importDatabase:function(){var t=this;this.importFile&&(this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.importFile.text().then((function(e){t.$jsonFetch.post("".concat(t.$global.data.baseUrl,"/db"),JSON.parse(e)).then((function(e){t.$q.loading.hide(),t.$q.notify({type:"positive",message:"ข้อมูลทั้งหมดในระบบฐานข้อมูลได้รับการแทนที่ข้อมูลเดิมเรียบร้อยแล้ว"})})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})}))})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})})))},exportDatabase:function(){var t=this;this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/db")).then((function(e){var a=document.createElement("a");a.href=URL.createObjectURL(new Blob([JSON.stringify(e.data,null,2)],{type:"text/plain"})),a.setAttribute("download","db.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.$nextTick((function(){t.$q.loading.hide()}))})).catch((function(e){t.$q.loading.hide(),console.error(e),t.$emit("error","Error ".concat(e.message)),t.$q.notify({type:"negative",message:"Error ".concat(e.message)})}))},exitProgram:function(){var t=this;console.log("Clear Authorization"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")}),this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/").concat(this.table,"?_page=1&_sort=id&_order=desc&_limit=1"),void 0,{headers:{Authorization:"Bearer ="}}).then((function(e){t.refreshPage()})).catch((function(e){t.refreshPage()}))},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},keepAwake:function(){var t=this,e=this.getRandomIntInclusive(3,5);setTimeout((function(e){t.$jsonFetch.get("".concat(t.baseUrl)).then((function(t){console.log(t,e)})).catch((function(t){console.error(t,e)})),t.keepAwake()}),60*e*1e3,e)},getRandomIntInclusive:function(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1)+t)},_debug:function(){var t;(t=console).log.apply(t,arguments)}}}}).call(this,a("1c35").Buffer)},"599a":function(t,e,a){},"5eaa":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"dealersRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"dealers",title:"ข้อมูลผู้จำหน่าย",classes:t.settings.classes,columns:t.dealerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o=a("1732"),r={name:"PageDealers",data:function(){return{dealerColumns:[{name:"id",label:"รหัสผู้จำหน่าย",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อผู้จำหน่าย",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataDealers:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("dealers")&&(this.$global.data.panelModel===this.$options.name?this.$refs.dealersRef.onRequest():this.isRequireLoadDataDealers||(this.isRequireLoadDataDealers=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataDealers&&(this.isRequireLoadDataDealers=!1,this.$refs.dealersRef.onRequest())}},methods:{onValidateData:function(t,e,a,s){return"address"===e.name||"telephone"===e.name||"email"===e.name||("text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))}}},l=r,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},"613c":function(t,e,a){"use strict";a("599a")},"66df":function(t,e,a){"use strict";a("9429")},7079:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=type&_expand=unit",table:"products",title:"รายการสินค้า",classes:t.settings.classes,columns:t.productColumns,onValidateData:t.onValidateData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData}}),a("div",{staticClass:"fit row wrap justify-evenly items-start content-start"},[a("JsonTable",{ref:"typesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},rowsPerPage:0,table:"types",title:"ประเภทสินค้า",classes:t.settings.classes,columns:t.typeColumns,onValidateData:t.onValidateData}}),a("JsonTable",{ref:"unitsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},rowsPerPage:0,table:"units",title:"หน่วยนับ",classes:t.settings.classes,columns:t.unitColumns,onValidateData:t.onValidateData}})],1)],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("4d90"),a("1276"),a("498a"),a("ec67")),o=a("1732"),r={name:"PageProducts",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,classes:"text-green-10 text-left",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"บาร์โค้ด",field:"barcode",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"คงเหลือ",field:"quantity",sortable:!0,classes:"text-green-10 text-weight-bold",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],typeColumns:[{name:"id",label:"รหัสประเภท",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ประเภทสินค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],unitColumns:[{name:"id",label:"รหัสหน่วยนับ",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"หน่วยนับ",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataProducts:!1,isRequireLoadDataTypes:!1,isRequireLoadDataUnits:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("products")?this.$global.data.panelModel===this.$options.name?this.$refs.productsRef.onRequest():this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0):t.request.path.split("/").includes("types")?this.$global.data.panelModel===this.$options.name?(this.$refs.typesRef.onRequest(),this.$refs.productsRef.onRequest()):(this.isRequireLoadDataTypes||(this.isRequireLoadDataTypes=!0),this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0)):t.request.path.split("/").includes("units")&&(this.$global.data.panelModel===this.$options.name?(this.$refs.unitsRef.onRequest(),this.$refs.productsRef.onRequest()):(this.isRequireLoadDataUnits||(this.isRequireLoadDataUnits=!0),this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0))))},"$global.data.panelModel":function(t,e){t===this.$options.name&&(this.isRequireLoadDataProducts&&(this.isRequireLoadDataProducts=!1,this.$refs.productsRef.onRequest()),this.isRequireLoadDataTypes&&(this.isRequireLoadDataTypes=!1,this.$refs.typesRef.onRequest()),this.isRequireLoadDataUnits&&(this.isRequireLoadDataUnits=!1,this.$refs.unitsRef.onRequest()))}},methods:{onValidateData:function(t,e,a,s){return"barcode"===e.name||"detail"===e.name||("typeId"===e.name||"unitId"===e.name||"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))},onBeforeUpdateData:function(t,e){e.price||(e.price=Math.round(e.cost+e.cost*this.settings.profit/100))},onAfterUpdateData:function(t,e,a){var s=this;if(e.barcode=e.barcode.trim(),!e.barcode){var i={id:e.id,barcode:"".concat(e.id).padStart(13,"0")};e.barcode=i.barcode,this.$jsonFetch.patch("".concat(this.$global.data.baseUrl,"/products/").concat(e.id),i,{params:{uid:this.UID}}).then((function(t){e.product=Object.assign({},t.data),s.$emit("update-cell","products",t.data,i)})).catch((function(t){}))}}}},l=r,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},"713b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"hHh lpR fFf"}},[a("q-header",{staticClass:"bg-primary text-white",attrs:{elevated:"","height-hint":"98"}},[a("q-toolbar",{staticClass:"bg-primary glossy text-white"},[a("q-fab",{attrs:{dense:"",flat:"",round:"",square:"",direction:"down","vertical-actions-align":"left",icon:"menu"},model:{value:t.menuModel,callback:function(e){t.menuModel=e},expression:"menuModel"}},[a("q-fab-action",{attrs:{glossy:"",square:"",color:"light-blue",label:"ขายสินค้า","label-position":"right",icon:"point_of_sale"},on:{click:function(e){t.panelModel="PageSales"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"cyan",label:"ซื้อสินค้า","label-position":"right",icon:"shopping_cart"},on:{click:function(e){t.panelModel="PagePurchases"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"teal",label:"ข้อมูลลูกค้า","label-position":"right",icon:"people"},on:{click:function(e){t.panelModel="PageCustomers"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"secondary",label:"ข้อมูลผู้จำหน่าย","label-position":"right",icon:"people_outline"},on:{click:function(e){t.panelModel="PageDealers"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"positive",label:"รายการสินค้า","label-position":"right",icon:"widgets"},on:{click:function(e){t.panelModel="PageProducts"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"accent",label:"พิมพ์บาร์โค้ด","label-position":"right",icon:"qr_code"},on:{click:function(e){t.panelModel="PagePrintBarcode"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"pink",label:"ประมวลผลข้อมูล","label-position":"right",icon:"auto_graph"},on:{click:function(e){t.panelModel="PageSummary"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"negative",label:"การตั้งค่า","label-position":"right",icon:"settings"},on:{click:function(e){t.panelModel="PageSettings"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"deep-orange",label:"ปิดระบบ","label-position":"right",icon:"power_settings_new"},on:{click:function(e){t.exitDialog=!0}}})],1),a("q-toolbar-title",[t._v("\n        "+t._s(t.settings.name)+"\n      ")]),a("q-btn-group",{attrs:{push:""}},[a("q-btn",{attrs:{glossy:"",color:"light-blue",icon:"point_of_sale"},on:{click:function(e){t.panelModel="PageSales"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-light-blue","content-style":"font-size: 14px;"}},[t._v("\n            ขายสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"cyan",icon:"shopping_cart"},on:{click:function(e){t.panelModel="PagePurchases"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-cyan","content-style":"font-size: 14px;"}},[t._v("\n            ซื้อสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"teal",icon:"people"},on:{click:function(e){t.panelModel="PageCustomers"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-teal","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลลูกค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"secondary",icon:"people_outline"},on:{click:function(e){t.panelModel="PageDealers"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-secondary","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลผู้จำหน่าย\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"positive",icon:"widgets"},on:{click:function(e){t.panelModel="PageProducts"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-positive","content-style":"font-size: 14px;"}},[t._v("\n            รายการสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"accent",icon:"qr_code"},on:{click:function(e){t.panelModel="PagePrintBarcode"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-accent","content-style":"font-size: 14px;"}},[t._v("\n            พิมพ์บาร์โค้ด\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"pink",icon:"auto_graph"},on:{click:function(e){t.panelModel="PageSummary"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-pink","content-style":"font-size: 14px;"}},[t._v("\n            ประมวลผลข้อมูล\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"negative",icon:"settings"},on:{click:function(e){t.panelModel="PageSettings"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-negative","content-style":"font-size: 14px;"}},[t._v("\n            การตั้งค่า\n          ")])],1),a("q-btn-dropdown",{attrs:{glossy:"",color:"deep-orange","dropdown-icon":"handyman"},scopedSlots:t._u([{key:"label",fn:function(){return[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-deep-orange","content-style":"font-size: 14px;"}},[t._v("\n              เครื่องมือ\n            ")])]},proxy:!0}])},[a("q-list",[a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.eventDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"primary","text-color":"white",icon:"help"}})],1),a("q-item-section",[a("q-item-label",[t._v("รายงานเหตุการณ์")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.showSetJsonServer=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"teal","text-color":"white",icon:"power"}})],1),a("q-item-section",[a("q-item-label",[t._v("การเชื่อมต่อข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.exportDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"positive","text-color":"white",icon:"cloud_download"}})],1),a("q-item-section",[a("q-item-label",[t._v("ส่งออกฐานข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.$refs.importFileRef.$el.click()}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"negative","text-color":"white",icon:"cloud_upload"}})],1),a("q-item-section",[a("q-item-label",[t._v("นำเข้าฐานข้อมูล")])],1)],1),a("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){t.exitDialog=!0}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{glossy:"",color:"deep-orange","text-color":"white",icon:"power_settings_new"}})],1),a("q-item-section",[a("q-item-label",[t._v("ปิดระบบ")])],1)],1)],1)],1)],1)],1)],1),a("q-page-container",[a("keep-alive",[t.isLoaded?a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:t.panelModel,callback:function(e){t.panelModel=e},expression:"panelModel"}},[a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSales"}},[a("keep-alive",[a("Sales")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PagePurchases"}},[a("keep-alive",[a("Purchases")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageCustomers"}},[a("keep-alive",[a("Customers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageDealers"}},[a("keep-alive",[a("Dealers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageProducts"}},[a("keep-alive",[a("Products")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PagePrintBarcode"}},[a("keep-alive",[a("PrintBarcode")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSummary"}},[a("keep-alive",[a("Summary")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"PageSettings"}},[a("keep-alive",[a("Settings")],1)],1)],1):t._e()],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showSetJsonServer,callback:function(e){t.showSetJsonServer=e},expression:"showSetJsonServer"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"500px"}},[a("q-input",{ref:"baseUrlInputRef",attrs:{type:"text",autofocus:"",clearable:"",counter:"",debounce:"200",label:"URL ของระบบฐานข้อมูล","stack-label":!0,"input-class":"text-primary",rules:[function(t){return t&&t.length>0||"ยังไม่ได้กำหนดข้อมูล"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.refreshPage(t.baseUrl)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.baseUrl=t.$global.data.baseUrl.replace(/\/api$/,""),t.$nextTick((function(){return t.$refs.baseUrlInputRef.resetValidation()}))}},model:{value:t.baseUrl,callback:function(e){t.baseUrl=e},expression:"baseUrl"}}),a("q-file",{attrs:{label:"โลโก้ แบบไม่มีสี"},on:{input:function(e){return t.setLocalStorageFromFile("logo",e)}},scopedSlots:t._u([{key:"default",fn:function(){return[a("img",{attrs:{src:t.images.logo,width:"80"}})]},proxy:!0}])}),a("q-file",{attrs:{label:"โลโก้ แบบมีสี"},on:{input:function(e){return t.setLocalStorageFromFile("logoColor",e)}},scopedSlots:t._u([{key:"default",fn:function(){return[a("img",{attrs:{src:t.images.logoColor,width:"80"}})]},proxy:!0}])})],1)]),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{attrs:{color:"primary",label:"ตกลง",disable:!(t.baseUrl&&t.baseUrl.length>0)},on:{click:function(e,a){return t.refreshPage(t.baseUrl)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showAuthentication,callback:function(e){t.showAuthentication=e},expression:"showAuthentication"}},[a("q-card",{staticStyle:{background:"radial-gradient(circle at center, rgba(255, 255, 255, 1.0), rgba(80, 160, 240, 0.8))"}},[a("q-card-section",{staticClass:"q-pa-none",attrs:{align:"evenly"}},[a("div",{staticClass:"q-pb-none",attrs:{align:"center"}},[a("img",{attrs:{src:t.images.logoColor,width:"300"}})])]),a("q-card-section",[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"500px"}},[a("q-input",{ref:"userInputRef",attrs:{type:"email",autofocus:"",clearable:"",counter:"",debounce:"200",label:"อีเมล์","stack-label":!0,"input-class":"text-center text-accent text-h4",rules:[function(t){return t&&t.length>0&&t.includes("@")||"ยังไม่ได้กำหนดข้อมูล อีเมล์"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.$refs.passwordInputRef.focus()}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.user=void 0,t.$nextTick((function(){return t.$refs.userInputRef.resetValidation()}))}},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}),a("q-input",{ref:"passwordInputRef",attrs:{type:"password",clearable:"",counter:"",debounce:"200",label:"รหัสผ่าน","stack-label":!0,"input-class":"text-center text-accent text-h4",rules:[function(t){return!t||t&&t.length>=0||"ยังไม่ได้กำหนดข้อมูล รหัสผ่าน"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0)&&t.loadSettings(!0)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.password=void 0,t.$nextTick((function(){return t.$refs.passwordInputRef.resetValidation()}))}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)]),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{attrs:{color:"primary",label:"เปิดใช้งาน",disable:!(t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0))},on:{click:function(e,a){return t.loadSettings(!0)}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale","full-width":""},model:{value:t.eventDialog,callback:function(e){t.eventDialog=e},expression:"eventDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("span",{staticClass:"q-ml-sm",staticStyle:{"white-space":"pre"}},[t._v(t._s(t.log))])])],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.exportDialog,callback:function(e){t.exportDialog=e},expression:"exportDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"positive","text-color":"white",icon:"cloud_download"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการส่งออกไฟล์ฐานข้อมูล (db.json)")]),a("span",{staticClass:"q-ml-sm"},[t._v("(คำแนะนำ) ข้อมูลทั้งหมดในระบบฐานข้อมูลจะได้รับการส่งออกไปบันทึกไว้ในไฟล์ db.json")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.exportDatabase()}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},on:{hide:function(e){t.importFile=void 0}},model:{value:t.importDialog,callback:function(e){t.importDialog=e},expression:"importDialog"}},[a("q-card",{staticClass:"bg-negative text-white",style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"warning","text-color":"white",icon:"cloud_upload"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการนำเข้าไฟล์ฐานข้อมูล (db.json)")]),a("span",{staticClass:"q-ml-sm"},[t._v("(คำเตือน) ข้อมูลทั้งหมดในระบบฐานข้อมูลจะได้รับการแทนที่ข้อมูลเดิมจากการนำเข้าของไฟล์ db.json")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.importDatabase()}}})],1)],1)],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.exitDialog,callback:function(e){t.exitDialog=e},expression:"exitDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v("Quasar Framework "+t._s(t.$q.version))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{color:"deep-orange","text-color":"white",icon:"power_settings_new"}}),a("span",{staticClass:"q-ml-sm"},[t._v("กรุณายืนยันการปิดระบบ")])],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ยกเลิก"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ตกลง"},on:{click:function(e){return t.exitProgram()}}})],1)],1)],1),a("q-file",{ref:"importFileRef",staticClass:"hidden",attrs:{accept:".json, application/json"},on:{input:function(e){t.importDialog=!0}},model:{value:t.importFile,callback:function(e){t.importFile=e},expression:"importFile"}})],1)},i=[],n=a("49de"),o=n["a"],r=(a("e040"),a("2877")),l=a("4d5a"),c=a("e359"),d=a("65c6"),u=a("c294"),p=a("72db"),f=a("6ac5"),h=a("cb32"),m=a("e7a9"),g=a("9c40"),b=a("05c0"),y=a("f20b"),v=a("1c1c"),x=a("66e5"),q=a("4074"),w=a("0170"),_=a("09e3"),D=a("adad"),C=a("823b"),R=a("7ff0"),$=a("24e8"),P=a("f09f"),k=a("a370"),I=a("d847"),S=a("2c91"),L=a("27f9"),U=a("7d53"),F=a("4b7e"),B=a("7f67"),j=a("75c3"),A=a("eebe"),E=a.n(A),O=Object(r["a"])(o,s,i,!1,null,"0de0d32c",null);e["default"]=O.exports;E()(O,"components",{QLayout:l["a"],QHeader:c["a"],QToolbar:d["a"],QFab:u["a"],QFabAction:p["a"],QToolbarTitle:f["a"],QAvatar:h["a"],QBtnGroup:m["a"],QBtn:g["a"],QTooltip:b["a"],QBtnDropdown:y["a"],QList:v["a"],QItem:x["a"],QItemSection:q["a"],QItemLabel:w["a"],QPageContainer:_["a"],QTabPanels:D["a"],QTabPanel:C["a"],QFooter:R["a"],QDialog:$["a"],QCard:P["a"],QCardSection:k["a"],QBar:I["a"],QSpace:S["a"],QInput:L["a"],QFile:U["a"],QCardActions:F["a"]}),E()(O,"directives",{ClosePopup:B["a"],TouchPan:j["a"]})},"7d5b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"customersRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"customers",title:"ข้อมูลลูกค้า",classes:t.settings.classes,columns:t.customerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o=a("1732"),r={name:"PageCustomers",data:function(){return{customerColumns:[{name:"id",label:"รหัสลูกค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อลูกค้า",field:"name",sortable:!0,classes:"text-green-10 text-left",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-left",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataCustomers:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("customers")&&(this.$global.data.panelModel===this.$options.name?this.$refs.customersRef.onRequest():this.isRequireLoadDataCustomers||(this.isRequireLoadDataCustomers=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataCustomers&&(this.isRequireLoadDataCustomers=!1,this.$refs.customersRef.onRequest())}},methods:{onValidateData:function(t,e,a,s){return"address"===e.name||"telephone"===e.name||"email"===e.name||("text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))}}},l=r,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},"83be":function(t,e,a){},9429:function(t,e,a){},caa3:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=type&_expand=unit",table:"products",title:"รายการสินค้า",classes:t.settings.classes,columns:t.productColumns.filter((function(t){return"printsPerItem"!==t.name})),hideAddButton:"",hideEditButton:"",hideRemoveButton:""},scopedSlots:t._u([{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"add",color:"orange",size:"xs"},on:{click:function(){return t.addSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มรายการพิมพ์บาร์โค้ด")])],1)]}}])}),a("JsonTable",{attrs:{title:"รายการพิมพ์บาร์โค้ด "+t.selectedRows.length+" รายการ",classes:t.settings.classes,columns:t.productColumns,hideSearchButton:"",hideRefreshButton:"",hideAddButton:"",hideEditButton:"",hideRemoveButton:"",hidePagination:""},on:{"update-cell":function(t,e){return e.hasRender=!1}},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-checkbox",{attrs:{label:"แสดงชื่อสินค้า"},model:{value:t.displayName,callback:function(e){t.displayName=e},expression:"displayName"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงราคาสินค้า"},model:{value:t.displayPrice,callback:function(e){t.displayPrice=e},expression:"displayPrice"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงบาร์โค้ด"},model:{value:t.displayBarcode,callback:function(e){t.displayBarcode=e},expression:"displayBarcode"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความกว้างของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeWidth=150}},model:{value:t.barcodeWidth,callback:function(e){t.barcodeWidth=t._n(e)},expression:"barcodeWidth"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความกว้างของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความสูงของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeHeight=40}},model:{value:t.barcodeHeight,callback:function(e){t.barcodeHeight=t._n(e)},expression:"barcodeHeight"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความสูงของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"จำนวนบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=100||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.printsPerItem=1}},model:{value:t.printsPerItem,callback:function(e){t.printsPerItem=t._n(e)},expression:"printsPerItem"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("จำนวนบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.printAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์บาร์โค้ด")])],1),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"clear",color:"red",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.removeAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการทั้งหมด")])],1)]}},{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"remove",color:"red",size:"xs"},on:{click:function(){return t.removeSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการพิมพ์บาร์โค้ด")])],1)]}}]),model:{value:t.selectedRows,callback:function(e){t.selectedRows=e},expression:"selectedRows"}}),a("q-page-sticky",{staticClass:"z-top",attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.printAllSelectedItem({})}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[t.selectedRows.length>0?a("div",{staticClass:"q-pa-md row wrap justify-start items-end content-start",staticStyle:{width:"780px",border:"1px solid black"},attrs:{id:"printBorder"}},t._l(t.barcodeItems,(function(e){return a("div",{key:e.key,staticClass:"q-pa-xs text-center",staticStyle:{overflow:"auto"}},[t.displayName?a("div",{staticClass:"text-bold",style:"width: "+t.barcodeWidth+"px;"},[t._v(t._s(e.name)+"\n        ")]):t._e(),t.displayPrice?a("div",{staticClass:"text-bold",staticStyle:{"font-size":"larger"}},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" "+t._s("บาท")+"\n        ")]):t._e(),a("svg",{class:"class-"+e.id})])})),0):t._e()])],1)},i=[],n=(a("99af"),a("c740"),a("4160"),a("caad"),a("13d5"),a("a434"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ec67")),o=a("1732"),r=a("a57a"),l=a.n(r),c={name:"PagePrintBarcode",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,classes:"text-left",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,classes:"text-center",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"บาร์โค้ด",field:"barcode",sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,classes:"text-left",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"คงเหลือ",field:"quantity",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"printsPerItem",label:"จำนวนบาร์โค้ด",field:"printsPerItem",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],selectedRows:[],isRequireLoadDataProducts:!1,displayName:!0,displayPrice:!0,displayBarcode:!0,barcodeWidth:150,barcodeHeight:40,printsPerItem:1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},computed:{settings:{get:function(){return this.$global.data.settings||{}}},barcodeItems:function(){var t=this;return this.selectedRows.reduce((function(e,a){for(var s=1;s<=a.printsPerItem;s++)e.push(Object.assign({},a,{key:"".concat(a.id,"-").concat(s)}));return t.renderBarcode(),e}),[])}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("products")||t.request.path.split("/").includes("types")||t.request.path.split("/").includes("units"))&&(this.$global.data.panelModel===this.$options.name?this.$refs.productsRef.onRequest():this.isRequireLoadDataProducts||(this.isRequireLoadDataProducts=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataProducts&&(this.isRequireLoadDataProducts=!1,this.$refs.productsRef.onRequest())},displayBarcode:function(t,e){this.renderBarcode(!0)},barcodeWidth:function(t,e){this.setBarcodeWidth()},barcodeHeight:function(t,e){this.renderBarcode(!0)}},methods:{addSelectedItem:function(t){if(t){var e=this.selectedRows.findIndex((function(e){return e.id===t.id}));e>=0?(this.selectedRows.splice(e,1,t),t.printsPerItem=(t.printsPerItem||0)+this.printsPerItem):(this.selectedRows.splice(this.selectedRows.length,0,t),this.$set(t,"printsPerItem",this.printsPerItem)),t.hasRender=!1}},removeSelectedItem:function(t){if(t){var e=this.selectedRows.findIndex((function(e){return e.id===t.id}));e>=0&&this.selectedRows.splice(e,1)}},removeAllSelectedItem:function(t){t&&this.selectedRows.splice(0,this.selectedRows.length)},printAllSelectedItem:function(t){var e=this;t&&this.selectedRows.length>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return e.printBorderVisibility(!0)})))},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},setBarcodeWidth:function(){var t=this;this.$nextTick((function(){document.querySelectorAll("svg[class^=class-]").forEach((function(e){e.setAttribute("width",t.barcodeWidth),e.removeAttribute("height")}))}))},renderBarcode:function(t){var e=this;this.$nextTick((function(){e.selectedRows.length>0&&(e.selectedRows.forEach((function(a){(!0===t||!a.hasRender&&(a.hasRender=!0))&&l()(".class-".concat(a.id),a.barcode,{format:"CODE128",font:"Sarabun",fontOptions:"bold",fontSize:20,margin:10,textMargin:2,width:2,height:e.barcodeHeight,displayValue:e.displayBarcode}).render()})),e.setBarcodeWidth())}))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"}}},d=c,u=a("2877"),p=a("9c40"),f=a("05c0"),h=a("8f8e"),m=a("2c91"),g=a("27f9"),b=a("de5e"),y=a("eebe"),v=a.n(y),x=Object(u["a"])(d,s,i,!1,null,null,null);e["a"]=x.exports;v()(x,"components",{QBtn:p["a"],QTooltip:f["a"],QCheckbox:h["a"],QSpace:m["a"],QInput:g["a"],QPageSticky:b["a"]})},e040:function(t,e,a){"use strict";a("83be")},ec67:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-md"},[a("q-table",{attrs:{"binary-state-sort":"","row-key":"id",selection:"single",separator:"cell",title:t.title,data:t.data,pagination:t.pagination,loading:t.loading,columns:t.columns,filter:t.filter,"hide-pagination":t.hidePagination,selected:t.selected,"table-class":["sticky-column-table",t.classes||""],"table-header-class":["sticky-column-table","text-bold",t.headerClasses||t.classes||""],"title-class":["text-bold",t.headerClasses||t.classes||""]},on:{"update:title":function(e){t.title=e},"update:data":function(e){t.data=e},"update:pagination":function(e){t.pagination=e},"update:loading":function(e){t.loading=e},"update:columns":function(e){t.columns=e},"update:filter":function(e){t.filter=e},"update:hidePagination":function(e){t.hidePagination=e},"update:hide-pagination":function(e){t.hidePagination=e},"update:selected":[function(e){t.selected=e},function(e){return t.selectItem(e)}],request:function(e){return t.onRequest(e)}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[t.hideSearchButton?t._e():a("q-input",{attrs:{dense:"",clearable:"",counter:"",debounce:"1000",placeholder:"ค้นหา"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}}),a("q-tooltip",{attrs:{"content-class":"bg-purple"}},[t._v("ค้นหาข้อมูล")])]},proxy:!0}],null,!0),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t.hideRefreshButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"refresh",color:"green",size:"xs"},on:{click:function(e){return e.stopPropagation(),function(){return t.onRequest(t.initialPagination)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("รีเฟรชข้อมูล")])],1),t.hideAddButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"add",color:"orange",size:"xs"},on:{click:function(e){return e.stopPropagation(),function(){return t.addItem()}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มข้อมูล")])],1),t._t("header",null,{props:e})]}},{key:"header",fn:function(e){return[a("q-tr",{attrs:{props:e}},[t.showSelectRows?a("q-th",{class:["text-bold bg-grey-5",t.headerClasses||t.classes||""],staticStyle:{"text-align":"center"},attrs:{"auto-width":!0}}):t._e(),t._l(e.cols,(function(s){return a("q-th",{key:s.name,class:["text-bold bg-grey-4",t.headerClasses||t.classes||"",s.headerClasses||""],staticStyle:{"text-align":"center"},attrs:{props:e,"auto-width":!0}},[a("span",{class:["text-bold bg-grey-4",t.headerClasses||t.classes||"",s.headerClasses||""]},[t._v("\n            "+t._s(s.label)+"\n          ")])])})),a("q-dialog",{attrs:{persistent:""},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"q-px-xl"},t._l(e.cols,(function(e){return a("div",{key:e.name},["text"===e.edit.type||"textarea"===e.edit.type||"password"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{type:e.edit.type,dense:"",counter:"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.dialogInputEnterKey(e)}(e))}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,a)},expression:"editedItem[col.name]"}})],1):t._e(),"number"===e.edit.type||"decimal"===e.edit.type?a("div",[e.name.endsWith("Id")?a("div",[e.edit.readonly&&t.editedItem.id?t._e():a("q-select",{attrs:{dense:"",counter:"",label:e.label,readonly:e.edit.readonly&&!!t.editedItem.id,"input-class":e.edit.inputClass||"text-right",prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}],options:t.filterOptions[e.name.slice(0,-2)+"s"],"option-label":function(a){return(("object"!==typeof a?a=t.editedItem[e.name.slice(0,-2)]:a)||{name:""}).name},"emit-value":"","map-options":"","option-value":"id","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(a,s,i){return t.filterFnAutoSelect(a,s,i,e.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn,input:function(a){return t.editedItem[""+e.name.slice(0,-2)]=t.filterOptions[e.name.slice(0,-2)+"s"].find((function(t){return t.id===a}))},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.dialogInputEnterKey(e)}(e))}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,t._n(a))},expression:"editedItem[col.name]"}})],1):a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{type:"number",dense:"",counter:"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass||"text-right",prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.dialogInputEnterKey(e)}(e))}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,t._n(a))},expression:"editedItem[col.name]"}})],1)]):t._e(),"datetime"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{value:t.bindDateTime(t.editedItem[e.name]),type:"datetime-local",dense:"",counter:"",label:e.label,"stack-label":!0,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{input:function(a){return t.editedItem[e.name]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.dialogInputEnterKey(e)}(e))}}})],1):t._e()])})),0),a("q-card-actions",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(e){return e.stopPropagation(),function(){return t.dialogVisible=!1}()}}}),a("q-btn",{attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:t.dialogVisible&&!0!==t.validateRow(t.editedItem,!0)},on:{click:function(e){return e.stopPropagation(),function(){return t.updateRow(t.editedItem)}()}}})],1)],1)],1)],2)]}},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[t.showSelectRows?a("q-td",{attrs:{"auto-width":!0}},[a("q-checkbox",{class:[t.classes||""],model:{value:e.selected,callback:function(a){t.$set(e,"selected",a)},expression:"props.selected"}})],1):t._e(),t._l(e.cols,(function(s){return a("q-td",{key:s.name,attrs:{props:e,"auto-width":!0}},[a("div",{class:[t.classes||"",s.classes||""]},["text"===s.edit.type||"textarea"===s.edit.type||"password"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-separator"),a("q-input",{attrs:{type:s.edit.type,autofocus:"",dense:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.popupEditEnterKey(e)}(e))}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",a)},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:t.popupVisible&&(!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row,!0)||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"number"===s.edit.type||"decimal"===s.edit.type?a("div",[s.name.endsWith("Id")?a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-separator"),a("q-select",{attrs:{autofocus:"",dense:"",counter:"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right",prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}],options:t.filterOptions[s.name.slice(0,-2)+"s"],"option-label":function(t){return(("object"!==typeof t?t=e.row[s.name.slice(0,-2)]:t)||{name:""}).name},"emit-value":"","map-options":"","option-value":"id","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(e,a,i){return t.filterFnAutoSelect(e,a,i,s.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.popupEditEnterKey(e)}(e))}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:t.popupVisible&&(!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row,!0)||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],e.row[s.name.slice(0,-2)]=t.filterOptions[s.name.slice(0,-2)+"s"].find((function(t){return t.id===e.row[s.name]})),t.updateCell(e.row,s)}()}}})],1)],1)])],1):a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-separator"),a("q-input",{attrs:{type:"number",autofocus:"",dense:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right",prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.popupEditEnterKey(e)}(e))}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:t.popupVisible&&(!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row,!0)||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1)]):t._e(),"datetime"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{input:function(e){return t.popupVisible=e},"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-separator"),a("q-input",{attrs:{value:t.bindDateTime(e.row["__"+s.name+"__"]),type:"datetime-local",autofocus:"",dense:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{input:function(a){return e.row["__"+s.name+"__"]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(e){return t.popupEditEnterKey(e)}(e))}}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:t.popupVisible&&(!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row,!0)||e.row["__"+s.name+"__"]===e.row[s.name])},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"actions"===s.name||"actions"===s.edit.type?a("div",{staticClass:"text-center"},[t.hideEditButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"edit",color:"blue",size:"xs"},on:{click:function(a){return a.stopPropagation(),function(){return t.editItem(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-blue"}},[t._v("แก้ไขข้อมูล")])],1),t.hideRemoveButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"remove",color:"red",size:"xs"},on:{click:function(a){return a.stopPropagation(),function(){return t.removeItem(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบข้อมูล")])],1),t._t("body",null,{props:e})],2):t._e()])])}))],2)]}},{key:"pagination",fn:function(e){return[a("div",{staticClass:"q-px-sm"},[t._v("\n        "+t._s(t.$q.lang.table.allRows+": "+t.pagination.rowsNumber)+"\n      ")]),a("q-btn",{attrs:{icon:"skip_previous",color:"primary",dense:"",flat:"",disable:e.isFirstPage},on:{click:e.firstPage}}),a("q-btn",{attrs:{icon:"fast_rewind",color:"primary",dense:"",flat:"",disable:e.isFirstPage},on:{click:e.prevPage}}),a("div",{staticClass:"q-px-sm text-bold text-primary"},[t._v("\n        "+t._s(t.pagination.page+" - "+t.pagesNumber)+"\n      ")]),a("q-btn",{attrs:{icon:"fast_forward",color:"primary",dense:"",flat:"",disable:e.isLastPage},on:{click:e.nextPage}}),a("q-btn",{attrs:{icon:"skip_next",color:"primary",dense:"",flat:"",disable:e.isLastPage},on:{click:e.lastPage}}),t._t("footer",null,{props:e})]}}],null,!0)})],1)},i=[],n=(a("99af"),a("a623"),a("4de4"),a("7db0"),a("a630"),a("caad"),a("c975"),a("fb6a"),a("a434"),a("b0c0"),a("a9e3"),a("cca6"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("8a79"),a("2532"),a("3ca3"),a("5319"),a("1276"),a("2ca0"),a("498a"),a("9523")),o=a.n(n),r=a("7037"),l=a.n(r),c=a("6374"),d=a.n(c),u={name:"JsonTable",model:{prop:"rows",event:"rows"},props:{title:{type:String,default:""},baseUrl:{type:String,default:""},query:{type:String,default:""},table:{type:String,default:""},classes:{type:String,default:""},headerClasses:{type:String,default:""},params:{type:Object,default:function(){}},columns:{type:Array,default:function(){return[]}},rows:{type:Array,default:function(){return[]}},rowsPerPage:{type:Number,default:10},hidePagination:{type:Boolean,default:!1},hideSearchButton:{type:Boolean,default:!1},hideRefreshButton:{type:Boolean,default:!1},hideAddButton:{type:Boolean,default:!1},hideEditButton:{type:Boolean,default:!1},hideRemoveButton:{type:Boolean,default:!1},showEditDialog:{type:Boolean,default:!1},showSelectRows:{type:Boolean,default:!1},onInitAddData:{type:Function,default:function(){}},onInitEditData:{type:Function,default:function(){}},onValidateData:{type:Function,default:function(){}},onBeforeLoadData:{type:Function,default:function(){}},onAfterLoadData:{type:Function,default:function(){}},onBeforeUpdateData:{type:Function,default:function(){}},onAfterUpdateData:{type:Function,default:function(){}},onBeforeRemoveData:{type:Function,default:function(){}},onAfterRemoveData:{type:Function,default:function(){}}},data:function(){return{loading:!1,dialogVisible:!1,popupVisible:!1,isNewItem:!1,filter:void 0,data:[],selected:[],argsRequireLoadData:[],dialogInputs:[],initialPagination:{pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:this.rowsPerPage,rowsNumber:0},filter:void 0},pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:this.rowsPerPage,rowsNumber:0},filterOptions:{},defaultItem:{},editedItem:{},dialogPos:{x:0,y:0}}},computed:{settings:{get:function(){return this.$global.data.settings||{}}},pagesNumber:function(){return this.pagination.rowsPerPage>0?Math.ceil(this.pagination.rowsNumber/this.pagination.rowsPerPage):1},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{query:function(t,e){this.onRequest(this.initialPagination)},rows:function(t,e){this.onBeforeLoadData("",t)||(this.data=t,this.pagination.rowsNumber=this.data.length,this.pagination.page=1,this.pagination.rowsPerPage=this.rowsPerPage,this.pagination.sortBy=void 0,this.pagination.descending=void 0,this.$emit("update:rows","",this.data),this.onAfterLoadData("",this.data)||this.$emit("load-data",this.table,this.data))},rowsPerPage:function(t,e){this.pagination.rowsPerPage=t},hidePagination:function(t,e){t?this.pagination.rowsPerPage=0:this.pagination.rowsPerPage<=0&&(this.pagination.rowsPerPage=10)},showEditDialog:function(t,e){this.dialogVisible=t},dialogVisible:function(t,e){var a=this;t?this.$nextTick((function(){var t=document.querySelector("div.q-dialog");if(t){a.dialogInputs=Array.from(t.querySelectorAll("input")),a.dialogInputs.length>0&&a.dialogInputs[0].focus();var e=Array.from(t.querySelectorAll("button"));e.length>0&&a.dialogInputs.push(e[e.length-1])}})):this.checkRequireLoadData()},popupVisible:function(t,e){t||this.checkRequireLoadData()},loading:function(t,e){t?this.$q.loading.show():this.$q.loading.hide()}},mounted:function(){this.onRequest(this.initialPagination)},methods:{checkRequireLoadData:function(){this.argsRequireLoadData&&(this.onRequest.apply(this,this.argsRequireLoadData),this.argsRequireLoadData=void 0)},onRequest:function(t,e){var a=this;if(this.dialogVisible||this.popupVisible)return this.argsRequireLoadData=arguments,void(this.loading=!1);if(!this.baseUrl||!this.table)return this.$emit("load-data",this.table,this.data),void(this.loading=!1);var s=Object.assign({},{pagination:this.pagination,filter:this.filter},t),i=s.pagination,n=i.page,o=i.rowsPerPage,r=i.sortBy,c=i.descending,u=s.filter;if(this.pagination.page=n,this.pagination.rowsPerPage=o,this.pagination.sortBy=r,this.pagination.descending=c,this.filter===u){var p="".concat(this.baseUrl,"/").concat(this.table,"?_sort=").concat(r,"&_order=").concat(c?"desc":"asc").concat(o&&o>0?"&_limit="+o+"&_page="+n:"").concat(u&&u.trim()?"&q="+u.trim():"").concat(this.query&&this.query.trim()?"&"+this.query.trim():"");this.loading=!0,this.$jsonFetch.get(p,{params:this.params}).then((function(t){if(a.onBeforeLoadData(p,t.data))a.loading=!1;else if(a.data=t.data,a.pagination.rowsNumber=t.headers["x-total-count"]||t.data.length,a.$emit("update:rows","",a.data),a.onAfterLoadData(p,a.data))a.loading=!1;else{var s;if(a.$emit("load-data",a.table,a.data),a.showSelectRows)e&&(s=a.data.find((function(t){return t.id===e}))),s?a.selected.splice(0,a.selected.length,s):(a.selected.length>0&&(s=a.data.find((function(t){return t.id===a.selected[0].id}))),s?a.selected.splice(0,a.selected.length,s):a.selected.length>0&&a.selected.splice(0,a.selected.length)),a.selectItem(s?[s]:[]);a.defaultItem={};var i,n=d()(a.columns);try{for(n.s();!(i=n.n()).done;){var o=i.value;"object"===l()(o)&&"string"===typeof o.name&&"object"===l()(o.edit)&&"actions"!==o.name&&("text"===o.edit.type||"textarea"===o.edit.type||"password"===o.edit.type||"datetime"===o.edit.type?a.defaultItem[o.name]="":"number"!==o.edit.type&&"decimal"!==o.edit.type||(a.defaultItem[o.name]=0))}}catch(r){n.e(r)}finally{n.f()}a.loading=!1}})).catch((function(t){a.loading=!1}))}else this.filter=u},selectItem:function(t){this.showSelectRows&&this.$emit("update:selected",this.selected)},addItem:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.isNewItem=!0,this.editedItem=Object.assign({},this.defaultItem),!this.onInitAddData(this.editedItem)&&t&&(this.dialogVisible=!0),this.editedItem},editItem:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.isNewItem=!1,this.editedItem=Object.assign({},this.defaultItem,t),!this.onInitEditData(this.editedItem)&&e&&(this.dialogVisible=!0),this.editedItem},removeItem:function(t){var e=this;this.baseUrl&&this.table?this.$q.dialog({title:"การลบข้อมูล",message:"กรุณายืนยันการลบข้อมูลของ ".concat(t.name||""," (รหัส ").concat(t.id,") ?"),ok:{glossy:!0,push:!0,color:"negative",label:"ยืนยันการลบ"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){var a="".concat(e.baseUrl,"/").concat(e.table,"/").concat(t.id);e.onBeforeRemoveData(a,t)?e.loading=!1:(e.loading=!0,e.$jsonFetch.delete(a,{params:e.params}).then((function(s){e.onAfterRemoveData(a,t,s.data)?e.loading=!1:(e.onRequest(),e.$emit("remove-row",e.table,s.data),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้ลบเรียบร้อยแล้ว")}))})).catch((function(t){e.loading=!1})))})):this.$emit("remove-row",this.table,t)},updateRow:function(t){var e=this;if(this.baseUrl&&this.table){if(!0===this.validateRow(t)){var a=function(a){var s=e.columns.find((function(t){return t.name===a}));s&&s.edit&&("number"!==s.edit.type&&"decimal"!==s.edit.type||isNaN(t[s.name])||(t[s.name]=+(t[s.name]||0)))};for(var s in t)a(s);if(this.isNewItem){delete t.id;var i="".concat(this.baseUrl,"/").concat(this.table);if(this.onBeforeUpdateData(i,t))return void(this.loading=!1);this.loading=!0,this.$jsonFetch.post(i,this.shallowCopy(t),{params:this.params}).then((function(a){a.data.id&&!t.id&&e.$set(t,"id",a.data.id),e.onAfterUpdateData(i,t,a.data)?e.loading=!1:(e.onRequest(e.initialPagination,t.id),e.$emit("add-row",e.table,a.data,t),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้เพิ่มเรียบร้อยแล้ว")}))})).catch((function(t){e.loading=!1}))}else{var n="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id);if(this.onBeforeUpdateData(n,t))return void(this.loading=!1);this.loading=!0,this.$jsonFetch.put(n,this.shallowCopy(t),{params:this.params}).then((function(a){e.onAfterUpdateData(n,t,a.data)?e.loading=!1:(e.onRequest(void 0,t.id),e.$emit("update-row",e.table,a.data,t),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้บันทึกเรียบร้อยแล้ว")}))})).catch((function(t){e.loading=!1}))}this.dialogVisible=!1}}else this.isNewItem?this.$emit("add-row",this.table,t,t):this.$emit("update-row",this.table,t,t)},updateCell:function(t,e){var a=this;if(this.baseUrl&&this.table){if(e&&e.edit){if(!0!==this.validateCell(t[e.name],e,t))return;"number"!==e.edit.type&&"decimal"!==e.edit.type||isNaN(t[e.name])||(t[e.name]=+(t[e.name]||0))}var s="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id),i=this.shallowCopy(t);if(this.onBeforeUpdateData(s,t))this.loading=!1;else{var n=o()({},e.name,t[e.name]);for(var r in i)"object"===l()(t[r])&&null!==t[r]||t[r]===i[r]||(n[r]=t[r]);this.loading=!0,this.$jsonFetch.patch(s,this.shallowCopy(n),{params:this.params}).then((function(e){a.onAfterUpdateData(s,t,e.data)?a.loading=!1:(a.onRequest(void 0,t.id),a.$emit("update-cell",a.table,e.data,n),a.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(a.table," ได้บันทึกเรียบร้อยแล้ว")}))})).catch((function(t){a.loading=!1}))}}else this.$emit("update-cell",this.table,t,t)},filterFnAutoSelect:function(t,e,a,s){var i=this;if(s){"string"===typeof t&&(t=t.replace(/[\\/^$.(){}[\]+*]/g,"").trim());var n="".concat(this.baseUrl,"/").concat(s,"?_sort=name&_order=asc&_limit=100&_expand=*").concat(t?"&name_like="+t:"");this.$jsonFetch.get(n,{params:this.params}).then((function(a){e((function(){i.$set(i.filterOptions,s,a.data)}),(function(e){""!==t&&e.options.length>0&&-1===e.optionIndex&&(e.moveOptionSelection(1,!0),e.toggleOption(e.options[e.optionIndex],!0))}))})).catch((function(t){a()}))}else a()},abortFilterFn:function(){},getCellDisplay:function(t,e){var a;return"number"===e.edit.type||"decimal"===e.edit.type?(a=e.name.endsWith("Id")?(t[e.name.slice(0,-2)]||{}).name||t[e.name]:this.getCellValue(e,t)||0,"decimal"===e.edit.type&&(a=(+a||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits}))):a=this.getCellValue(e,t),0===a&&"NaN"!==a||(a=a||" "),"".concat(e.edit.prefix).concat(a).concat(e.edit.suffix)},bindDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),new Date(t.getTime()-60*t.getTimezoneOffset()*1e3).toISOString().split(".")[0]},eventDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),t.toISOString()},getCellValue:function(t,e){var a="function"===typeof t.field?t.field(e):e[t.field];return"function"===typeof t.format?t.format(a,e):a},dialogInputEnterKey:function(t){var e=this.dialogInputs.indexOf(t.target);e>=0&&e<this.dialogInputs.length&&this.dialogInputs[e+1].focus()},popupEditEnterKey:function(t){var e=document.querySelector("body>div.q-menu>div>div>button.q-btn.q-btn-item.bg-secondary");e&&e.click()},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},validateCell:function(t,e,a,s){var i=e.name.includes(".")||this.onValidateData(t,e,a,s);return void 0===i&&(i="text"===e.edit.type||"textarea"===e.edit.type||"password"===e.edit.type||"datetime"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0")),i},validateRow:function(t,e){var a=this,s=function(s){var i=a.columns.find((function(t){return t.name===s}));if(i&&i.edit&&!0!==a.validateCell(t[i.name],i,t,e))return{v:!1}};for(var i in t){var n=s(i);if("object"===l()(n))return n.v}return!0},deepCompare:function(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)&&("[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((function(a){return this.deepCompare(t[a],e[a])})):t===e)},deepCopy:function(t){if("object"!==l()(t))return t;if(null!==t){var e=Array.isArray(t)?[]:{};for(var a in t)e[a]=this.deepCopy(t[a]);return e}},shallowCopy:function(t){var e=Array.isArray(t)?[]:{};for(var a in t)("object"!==l()(t[a])||Array.isArray(t[a])||null===t[a])&&(a.startsWith("_")||a.includes(".")||(e[a]=t[a]));return e},showDialog:function(){this.dialogVisible=!0},hideDialog:function(){this.dialogVisible=!1},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},p=u,f=(a("613c"),a("2877")),h=a("eaac"),m=a("27f9"),g=a("0016"),b=a("05c0"),y=a("9c40"),v=a("bd08"),x=a("357e"),q=a("8f8e"),w=a("24e8"),_=a("f09f"),D=a("a370"),C=a("d847"),R=a("2c91"),$=a("ddd8"),P=a("4b7e"),k=a("db86"),I=a("7cbe"),S=a("eb85"),L=a("4e73"),U=a("75c3"),F=a("7f67"),B=a("eebe"),j=a.n(B),A=Object(f["a"])(p,s,i,!1,null,null,null);e["a"]=A.exports;j()(A,"components",{QTable:h["a"],QInput:m["a"],QIcon:g["a"],QTooltip:b["a"],QBtn:y["a"],QTr:v["a"],QTh:x["a"],QCheckbox:q["a"],QDialog:w["a"],QCard:_["a"],QCardSection:D["a"],QBar:C["a"],QSpace:R["a"],QSelect:$["a"],QCardActions:P["a"],QTd:k["a"],QPopupProxy:I["a"],QSeparator:S["a"],QMenu:L["a"]}),j()(A,"directives",{TouchPan:U["a"],ClosePopup:F["a"]})},f9ea:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"aboutSettingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"ข้อมูลกิจการ","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:(t.$global.data.settings||{}).classes,columns:t.aboutColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}}),a("JsonTable",{ref:"programSettingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"ข้อมูลโปรแกรม","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:(t.$global.data.settings||{}).classes,columns:t.settingColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}})],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("38cf"),a("1276"),a("ec67")),o=a("1732"),r={name:"PageSettings",data:function(){return{aboutColumns:[{name:"id",label:"รหัสกิจการ",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อกิจการ",field:"name",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10 text-center",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"password",label:"รหัสผ่าน",field:function(t){return"•".repeat((t.password||"").length)},sortable:!1,classes:"text-green-10 text-center",edit:{type:"password",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],settingColumns:[{name:"id",label:"รหัสการตั้งค่า",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantityPurchase",label:"จำนวนซื้อเริ่มต้น",field:"quantityPurchase",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"quantitySale",label:"จำนวนขายเริ่มต้น",field:"quantitySale",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"profit",label:"กำไร",field:"profit",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatPurchase",label:"ภาษีซื้อ",field:"vatPurchase",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatSale",label:"ภาษีขาย",field:"vatSale",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"fractionDigits",label:"จุดทศนิยม",field:"fractionDigits",sortable:!0,classes:"text-green-10 text-center",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"classes",label:"Cascading Style Sheets",field:"classes",sortable:!0,classes:"text-green-10 text-center",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],isRequireLoadDataSettings:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])()},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("settings")&&(this.$global.data.panelModel===this.$options.name?(this.$refs.aboutSettingsRef.onRequest(),this.$refs.programSettingsRef.onRequest(),t.response.body&&this.updateHandler("",t.response.body)):this.isRequireLoadDataSettings||(this.isRequireLoadDataSettings=!0))},"$global.data.panelModel":function(t,e){t===this.$options.name&&this.isRequireLoadDataSettings&&(this.isRequireLoadDataSettings=!1,this.$refs.aboutSettingsRef.onRequest(),this.$refs.programSettingsRef.onRequest())}},methods:{updateHandler:function(t,e){this.$global.data.settings=Object.assign({},this.$global.data.settings,e),"settings"!==t||!e||e.email===this.$global.data.users.name&&e.password===this.$global.data.users.password||this.updateUserToken(e.email,e.password)},updateUserToken:function(t,e){var a=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/jwt/sign?name=").concat(t,"&password=").concat(e)).then((function(s){var i=s.data.token;a.$jsonFetch.get("".concat(a.$global.data.baseUrl,"/__users"),void 0,{params:{name:t}}).then((function(s){s.data.length>0?a.$jsonFetch.patch("".concat(a.$global.data.baseUrl,"/__users/").concat(s.data[0].id),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){})):a.$jsonFetch.post("".concat(a.$global.data.baseUrl,"/__users"),{name:t,type:"Bearer",token:i},{params:{uid:a.UID}}).then((function(t){a.$global.data.users={name:t.data.name,password:e}})).catch((function(t){}))})).catch((function(t){}))})).catch((function(t){}))}}},l=r,c=a("2877"),d=Object(c["a"])(l,s,i,!1,null,null,null);e["a"]=d.exports},fbb2:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"salesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=customer",table:"sales",title:"รายการขายสินค้า",classes:t.settings.classes,columns:t.saleColumns,onInitAddData:t.onInitAddDataSales,onValidateData:t.onValidateDataSales,onAfterLoadData:t.onAfterLoadDataSales,onBeforeUpdateData:t.onBeforeUpdateDataSales,onBeforeRemoveData:t.onBeforeRemoveDataSales,onAfterRemoveData:t.onAfterRemoveDataSales,rowsPerPage:1}}),a("JsonTable",{ref:"saleProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:t.query,table:"saleProducts",title:t.title,classes:t.settings.classes,columns:t.saleProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onBeforeLoadData:t.onBeforeLoadData,onAfterLoadData:t.onAfterLoadData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData,onBeforeRemoveData:t.onBeforeRemoveData,onAfterRemoveData:t.onAfterRemoveData,rowsPerPage:0,showEditDialog:t.showEditDialog,hidePagination:""}}),a("q-page-sticky",{staticClass:"z-top",attrs:{position:"top-left",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"record_voice_over",color:t.speechColor,size:"xs",disable:Object.keys(t.saleRow).length<=0},on:{click:function(){return t.$speechApi.recognizing?t.$speechApi.abort():t.$speechApi.start()}}})],1),a("q-page-sticky",{staticClass:"z-top",attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:Object.keys(t.saleRow).length<=0||(+t.saleRow.net||0)<=0},on:{click:function(){return t.printData()}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[Object.keys(t.saleRow).length>0?a("div",{staticClass:"q-pa-none row wrap justify-center items-start content-start",staticStyle:{width:"297px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-sm text-bold"},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("img",{attrs:{src:t.images.logo,width:"150"}}),t.settings.address?a("div",[t._v("\n            "+t._s(t.settings.address)+"\n          ")]):t._e(),t.settings.telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s(t.settings.telephone)+"\n          ")]):t._e(),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลส่งสินค้า\n          ")]),t.saleRow.date?a("div",{attrs:{align:"center"}},[t._v("\n            "+t._s(new Date(t.saleRow.date).toLocaleString("th-TH",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}))+" น.\n          ")]):t._e(),t.saleRow.customer?a("div",{attrs:{align:"left"}},[t.saleRow.customer.name?a("div",[t._v("\n              นาม: "+t._s(t.saleRow.customer.name)+"\n            ")]):t._e(),t.saleRow.customer.address?a("div",[t._v("\n              ที่อยู่: "+t._s(t.saleRow.customer.address)+"\n            ")]):t._e(),t.saleRow.customer.telephone?a("div",[t._v("\n              โทรศัพท์: "+t._s(t.saleRow.customer.telephone)+"\n            ")]):t._e()]):t._e()]),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l((t.$refs.saleProductsRef||{}).data,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-right"},[t._v(t._s(e.quantity)+"\n              ")]),a("div",{staticClass:"q-px-xs col",staticStyle:{"white-space":"nowrap",overflow:"hidden"}},[t._v(t._s(e.product.name))]),a("div",{staticClass:"col-2 text-right"},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-4"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.saleProductsRef||{}).data||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" หน่วย")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.saleProductsRef||{}).data||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col-7"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.saleRow.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]),t.saleRow.discount?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.saleRow.discount||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.saleRow.vat?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.saleRow.total>0?(+t.saleRow.total-+t.saleRow.discount)*+t.saleRow.vat/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s((+t.saleRow.net||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])]),t.saleRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ชำระเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.saleRow.cash||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e(),t.saleRow.cash?a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ทอนเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.saleRow.cash?+t.saleRow.cash-+t.saleRow.net:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])]):t._e()])])]),t._m(1)])]):t._e()]),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:t.cashDialog,callback:function(e){t.cashDialog=e},expression:"cashDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pa-md"},[a("q-input",{staticClass:"no-spin-button",attrs:{type:"number",autofocus:"",counter:"",debounce:"500",label:"ชำระเงิน","input-class":"text-right text-h3",rules:[function(t){return t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.cashValue>0&&Object.keys(t.saleRow).length>0&&t.updateCash(t.saleRow)}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()}},model:{value:t.cashValue,callback:function(e){t.cashValue=t._n(e)},expression:"cashValue"}}),a("q-input",{attrs:{value:(+t.saleRow.net||0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ราคาสุทธิ","input-class":"text-right text-h3"}}),a("q-input",{attrs:{value:(t.cashValue>+t.saleRow.net?t.cashValue-+t.saleRow.net:0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ทอนเงิน","input-class":"text-right text-h3"}})],1)]),a("q-card-section",[a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{glossy:"",color:"grey",label:"1000"},on:{click:function(e,a){return t.cashValueThrottle(1e3)}}}),a("q-btn",{attrs:{glossy:"",color:"purple",label:"500"},on:{click:function(e,a){return t.cashValueThrottle(500)}}}),a("q-btn",{attrs:{glossy:"",color:"red",label:"100"},on:{click:function(e,a){return t.cashValueThrottle(100)}}}),a("q-btn",{attrs:{glossy:"",color:"blue",label:"50"},on:{click:function(e,a){return t.cashValueThrottle(50)}}}),a("q-btn",{attrs:{glossy:"",color:"green",label:"20"},on:{click:function(e,a){return t.cashValueThrottle(20)}}})],1),a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-10",label:"10"},on:{click:function(e,a){return t.cashValueThrottle(10)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-9",label:"5"},on:{click:function(e,a){return t.cashValueThrottle(5)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-8",label:"2"},on:{click:function(e,a){return t.cashValueThrottle(2)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-7",label:"1"},on:{click:function(e,a){return t.cashValueThrottle(1)}}})],1),a("q-separator")],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ย้อนกลับไป"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"secondary",label:"รับเงิน ไม่พิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.saleRow.net||0)},on:{click:function(e,a){return t.cashValue>0&&Object.keys(t.saleRow).length>0&&t.updateCash(t.saleRow,!1)}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"positive",label:"รับเงิน และพิมพ์",disable:t.cashValue<=0||t.cashValue<(+t.saleRow.net||0)},on:{click:function(e,a){return t.cashValue>0&&Object.keys(t.saleRow).length>0&&t.updateCash(t.saleRow)}}})],1)],1)],1),a("q-dialog",{attrs:{"auto-close":"","transition-show":"scale","transition-hide":"scale"},model:{value:t.showProductSpeech,callback:function(e){t.showProductSpeech=e},expression:"showProductSpeech"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pa-none",staticStyle:{"min-width":"350px"}},[a("q-list",{attrs:{bordered:"",separator:""}},t._l(t.speechProductRows,(function(e){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.id,attrs:{clickable:""},on:{click:function(){return t.addProductItem(e)}}},[a("q-item-section",{staticClass:"text-bold",staticStyle:{"font-size":"larger"}},[t._v("\n                "+t._s(e.name)+" ("+t._s(e.price)+" บาท ต่อ "+t._s(e.unit.name||"หน่วย")+")\n              ")])],1)})),1)],1)])],1)],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1 text-center"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-2 text-center"},[t._v("ราคา")]),a("div",{staticClass:"col-3 text-center"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("7db0"),a("4160"),a("caad"),a("13d5"),a("b0c0"),a("b680"),a("cca6"),a("b64b"),a("ac1f"),a("2532"),a("1276"),a("498a"),a("159b"),a("ec67")),o=a("1732"),r=a("e302"),l={name:"PageSales",data:function(){return{saleColumns:[{name:"id",label:"รหัสขาย",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"customerId",label:"ลูกค้า",field:"customerId",sortable:!0,classes:"text-green-10 text-left",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:"net",sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cash",label:"ชำระเงิน",field:"cash",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"change",label:"ทอนเงิน",field:function(t){return t.cash?t.cash-t.net:0},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],saleProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return t.product.id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product.type||{name:void 0}).name},sortable:!0,classes:"text-left",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product.unit||{name:void 0}).name},sortable:!0,classes:"text-center",edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,classes:"text-left",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"product.cost",label:"ราคาทุน",field:function(t){return t.product.cost},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.price",label:"ราคาขาย",field:function(t){return t.product.price},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคา",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"total",label:"ราคารวม",field:"total",sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.quantity",label:"คงเหลือ",field:function(t){return t.product.quantity},sortable:!0,classes:"text-weight-bold",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],query:"_expand=product&_expand=type&_expand=unit&saleId=".concat(void 0),title:"ขายสินค้า",saleRow:{},isRequireLoadDataSales:!1,isRequireLoadDataSaleProducts:!1,showEditDialog:!1,cashDialog:!1,cashValue:0,speechColor:"green",speechProductRows:[],showProductSpeech:!1,dialogPos:{x:0,y:0}}},components:{JsonTable:n["a"]},created:function(){var t=this;this.UID=Object(o["a"])(),this.cashValueThrottle=Object(r["a"])((function(e){t.cashValue+=e}),500)},computed:{settings:{get:function(){return this.$global.data.settings||{}}},images:{get:function(){return this.$global.data.images||{}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{"$global.data.modify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("sales")?this.$global.data.panelModel===this.$options.name?this.$refs.salesRef.onRequest():this.isRequireLoadDataSales||(this.isRequireLoadDataSales=!0):t.request.path.split("/").includes("saleProducts")&&(this.$global.data.panelModel===this.$options.name?this.$refs.saleProductsRef.onRequest():this.isRequireLoadDataSaleProducts||(this.isRequireLoadDataSaleProducts=!0)))},"$global.data.panelModel":function(t,e){t===this.$options.name&&(this.isRequireLoadDataSales&&(this.isRequireLoadDataSales=!1,this.$refs.salesRef.onRequest()),this.isRequireLoadDataSaleProducts&&(this.isRequireLoadDataSaleProducts=!1,this.$refs.saleProductsRef.onRequest())),this.$speechApi.abort()}},mounted:function(){var t=this;void 0===this._keyListener.timeStamp&&(this._keyListener.timeStamp=0,window._keyListener||(window.addEventListener("keydown",this._keyListener),window._keyListener=this._keyListener)),this.$speechApi.onstart=function(){t.speechColor="red"},this.$speechApi.onend=function(){t.speechColor="green"},this.$speechApi.onresult=function(e){t.findProductSpeech(e)}},beforeDestroy:function(){void 0!==this._keyListener.timeStamp&&(window.removeEventListener("keydown",this._keyListener),delete window._keyListener)},methods:{onInitAddDataSales:function(t){t.date=(new Date).toISOString(),t.vat=this.settings.vatSale,t.customerId=+this.saleRow.customerId||0,t.customer=this.saleRow.customer},onValidateDataSales:function(t,e,a,s){return"customerId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลลูกค้า":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onAfterLoadDataSales:function(t,e){1===e.length?(this.saleRow=e[0],this.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(this.saleRow.id),this.title="ขายสินค้า ".concat((e[0].customer||{}).name," [").concat(this.saleRow.id,"] (").concat(new Date(e[0].date).toLocaleString(),")"),this.$global.scrollToElement("scrollToThis",1e3,1e3)):(this.saleRow={},this.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(this.saleRow.id),this.title="ขายสินค้า"),document.activeElement.blur()},onBeforeUpdateDataSales:function(t,e){e.id||(e.date=(new Date).toISOString()),e.net=+e.total-+e.discount,e.net=e.net+e.net*+e.vat/100,e.net=+e.net.toFixed(this.settings.fractionDigits)},onBeforeRemoveDataSales:function(t,e){console.log("Event onBeforeRemoveDataSales")},onAfterRemoveDataSales:function(t,e,a){var s=this;a&&a.__deleted__&&a.__deleted__.saleProducts&&a.__deleted__.saleProducts.forEach((function(t){s.updateProduct({productId:t.productId,quantity:0,__:{quantity:t.quantity}})}))},onInitAddData:function(t){if(!this.saleRow.id)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t),t.quantity=+this.settings.quantitySale},onInitEditData:function(t){if(!this.saleRow.id)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t)},onValidateData:function(t,e,a,s){return"productId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===e.name?t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":!(a.product.quantity-(t-a.__.quantity)<0)||(a.product.quantity<=0?(!s&&this.$q.notify({type:"warning",icon:"report_problem",position:"top",caption:"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name),message:"สินค้า: ".concat(a.product.name," (สินค้าหมด)"),multiLine:!0,progress:!0,timeout:1e4,actions:[{label:"ตกลง",color:"white",handler:function(){}}]}),"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name)):(!s&&this.$q.notify({type:"negative",icon:"report_problem",position:"top",caption:"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name),message:"สินค้า: ".concat(a.product.name," (ไม่เพียงพอ)"),multiLine:!0,progress:!0,timeout:1e4,actions:[{label:"ตกลง",color:"white",handler:function(){}}]}),"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name))):"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onBeforeLoadData:function(t,e){var a=this;e.forEach((function(t){return a.initialData(t)}))},onAfterLoadData:function(t,e){this.onAfterLoadData.productItem&&(this.addProductItem(this.onAfterLoadData.productItem),delete this.onAfterLoadData.productItem),document.activeElement.blur()},onBeforeUpdateData:function(t,e){e.product&&(e["product.id"]=e.product.id,e["product.type.name"]=(e.product.type||{name:""}).name,e["product.unit.name"]=(e.product.unit||{name:""}).name,e["product.cost"]=e.product.cost,e["product.price"]=e.product.price,e["product.quantity"]=e.product.quantity),e.price=+(+e["product.price"]-+e.discount).toFixed(this.settings.fractionDigits),e.total=+(+e.quantity*+e.price).toFixed(this.settings.fractionDigits)},onAfterUpdateData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},onBeforeRemoveData:function(t,e){e.__.quantity=e.quantity,e.quantity=0},onAfterRemoveData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},initialData:function(t){t.saleId||(t.saleId=this.saleRow.id),t.__=Object.assign({},t.__,{quantity:t.quantity})},updateTotal:function(t){var e=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/saleProducts?saleId=").concat(this.saleRow.id),{params:{uid:this.UID}}).then((function(a){if(Object.keys(e.saleRow).length>0){var s={total:+a.data.reduce((function(t,e){return t+e.total}),0).toFixed(e.settings.fractionDigits)};s.net=s.total-+e.saleRow.discount,s.net=s.net+s.net*+e.saleRow.vat/100,s.net=+s.net.toFixed(e.settings.fractionDigits),e.$jsonFetch.patch("".concat(e.$global.data.baseUrl,"/sales/").concat(e.saleRow.id),s,{params:{uid:e.UID}}).then((function(a){e.saleRow.total=a.data.total,e.saleRow.net=a.data.net,t.__.quantity=t.quantity,e.$emit("update-cell","sales",a.data,s)})).catch((function(t){}))}else e.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(e.saleRow.id),e.title="ขายสินค้า"})).catch((function(t){}))},updateProduct:function(t){var e=this,a={id:t.productId,quantityDelta:+t.__.quantity-+t.quantity};this.$jsonFetch.patch("".concat(this.$global.data.baseUrl,"/products/").concat(t.productId),a,{params:{uid:this.UID}}).then((function(s){t.product=Object.assign({},s.data),e.$emit("update-cell","products",s.data,a)})).catch((function(t){}))},updateCash:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.cashDialog=!1,t.cash=this.cashValue;var s={id:t.id,cash:t.cash};this.$jsonFetch.patch("".concat(this.$global.data.baseUrl,"/sales/").concat(t.id),s,{params:{uid:this.UID}}).then((function(t){a&&(e.printBorderVisibility(!1),e.$global.print("#print",e.settings.name,(function(){return e.printBorderVisibility(!0)}))),e.$emit("update-cell","sales",t.data,s)})).catch((function(t){}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},printData:function(){var t=this;this.saleRow.cash?(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return t.printBorderVisibility(!0)}))):(this.cashDialog=!0,this.cashValue=0)},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"},_keyListener:function(t){if(this.$global.data.panelModel===this.$options.name){var e=document.activeElement.nodeName;if("BODY"!==e&&"INPUT"!==e&&document.activeElement.blur(),t.timeStamp-(this._keyListener.timeStamp||0)>2e3)"Enter"===t.key?(t.preventDefault(),t.stopPropagation(),this._keyListener.text=""):this._keyListener.text=t.key;else{if("Enter"===t.key){t.preventDefault(),t.stopPropagation();var a=this._keyListener.text.trim();return this._keyListener.text="",a&&"INPUT"!==t.target.nodeName&&this.findProductBarcode(a),!1}this._keyListener.text+=t.key}this._keyListener.timeStamp=t.timeStamp}},findProductBarcode:function(t){var e=this;this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/products?_expand=type&_expand=unit&barcode=").concat(t),{params:{uid:this.UID}}).then((function(a){if(a.data&&a.data.length>0)if(!e.saleRow.id||e.saleRow.cash){var s=e.$refs.salesRef.addItem(!1);s.customerId||(s.customerId=1),e.$refs.salesRef.updateRow(s),e.onAfterLoadData.productItem=a.data[0]}else e.addProductItem(a.data[0]);else e.$q.notify({type:"warning",html:!0,message:"ไม่พบบาร์โค้ด ".concat(t)})})).catch((function(t){}))},addProductItem:function(t){if(t&&t.id){var e,a=this.$refs.saleProductsRef.data.find((function(e){return e.productId===t.id}));a?(e=this.$refs.saleProductsRef.editItem(!1),e.__.quantity=a.quantity,e.id=a.id,e.discount=+a.discount,e.quantity=+a.quantity+ +this.settings.quantitySale):(e=this.$refs.saleProductsRef.addItem(!1),e.__.quantity=0),e.product=t,e.productId=e.product.id,this.$refs.saleProductsRef.updateRow(e)}},findProductSpeech:function(t){var e=this;Object.keys(this.saleRow).length>0?this.$jsonFetch.get("".concat(this.$global.data.baseUrl,"/products?_sort=name&_order=asc&_limit=100&_expand=*&name_like=").concat(t),{params:{uid:this.UID}}).then((function(a){a.data&&a.data.length>0?(e.speechProductRows=a.data,e.showProductSpeech=!0):e.$q.notify({type:"warning",html:!0,message:"ไม่พบสินค้า ".concat(t)})})).catch((function(t){})):this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"})},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}}}},c=l,d=(a("66df"),a("2877")),u=a("de5e"),p=a("9c40"),f=a("24e8"),h=a("f09f"),m=a("a370"),g=a("d847"),b=a("2c91"),y=a("27f9"),v=a("eb85"),x=a("4b7e"),q=a("1c1c"),w=a("66e5"),_=a("4074"),D=a("75c3"),C=a("7f67"),R=a("714f"),$=a("eebe"),P=a.n($),k=Object(d["a"])(c,s,i,!1,null,"554c574b",null);e["a"]=k.exports;P()(k,"components",{QPageSticky:u["a"],QBtn:p["a"],QDialog:f["a"],QCard:h["a"],QCardSection:m["a"],QBar:g["a"],QSpace:b["a"],QInput:y["a"],QSeparator:v["a"],QCardActions:x["a"],QList:q["a"],QItem:w["a"],QItemSection:_["a"]}),P()(k,"directives",{TouchPan:D["a"],ClosePopup:C["a"],Ripple:R["a"]})}}]);
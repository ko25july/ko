(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"10b3":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"purchasesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=dealer",table:"purchases",title:"รายการซื้อสินค้า",classes:t.settings.classes,columns:t.purchaseColumns,onInitAddData:t.onInitAddDataPurchases,onValidateData:t.onValidateDataPurchases,onAfterLoadData:t.onAfterLoadDataPurchases,onBeforeUpdateData:t.onBeforeUpdateDataPurchases,onBeforeRemoveData:t.onBeforeRemoveDataPurchases,onAfterRemoveData:t.onAfterRemoveDataPurchases,selected:t.selectedRows,showSelectRows:""},on:{"update:selected":[function(e){t.selectedRows=e},t.onSelectedRows]}}),a("JsonTable",{ref:"purchaseProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:t.query,table:"purchaseProducts",title:t.title,classes:t.settings.classes,columns:t.purchaseProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onBeforeLoadData:t.onBeforeLoadData,onAfterLoadData:t.onAfterLoadData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData,onBeforeRemoveData:t.onBeforeRemoveData,onAfterRemoveData:t.onAfterRemoveData,showEditDialog:t.showEditDialog,rowsPerPage:0,hidePagination:""}},[a("template",{slot:"header"},[a("div",{staticClass:"q-pl-md"},[a("q-markup-table",{attrs:{dense:""}},[a("tbody",[a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.purchaseColumns[5].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s(t.getDecimal((t.selectedRows[0]||{total:0}).total)))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.purchaseColumns[3].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s((t.selectedRows[0]||{discount:0}).discount))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v(t._s(t.purchaseColumns[3].edit.suffix))])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.purchaseColumns[4].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s((t.selectedRows[0]||{vat:0}).vat))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v(t._s(t.purchaseColumns[4].edit.suffix))])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.purchaseColumns[6].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px","font-weight":"bold"}},[t._v(t._s(t.getDecimal((t.selectedRows[0]||{net:0}).net)))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v("บาท")])])])])],1)])],2),a("q-page-sticky",{attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0||t.selectedRows[0].net<=0},on:{click:function(){return t.printSelectedItem()}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[t.selectedRows.length>0?a("div",{staticClass:"q-pa-md row wrap justify-center items-start content-start",staticStyle:{width:"790px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-none text-bold",staticStyle:{width:"722px","font-size":"larger"}},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[(t.selectedRows[0].dealer||{}).name?a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            "+t._s((t.selectedRows[0].dealer||{}).name)+"\n          ")]):t._e(),(t.selectedRows[0].dealer||{}).address?a("div",[t._v("\n            "+t._s((t.selectedRows[0].dealer||{}).address)+"\n          ")]):t._e(),(t.selectedRows[0].dealer||{}).telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s((t.selectedRows[0].dealer||{}).telephone)+"\n          ")]):t._e(),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลสั่งสินค้า\n          ")]),t.selectedRows.length>0&&t.selectedRows[0].date?a("div",{attrs:{align:"center"}},[t._v("\n            วันที่: "+t._s(new Date(t.selectedRows[0].date).toLocaleString())+"\n          ")]):t._e()]),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l((t.$refs.purchaseProductsRef||{}).data,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-center"},[t._v(t._s(e.quantity))]),a("div",{staticClass:"col"},[t._v(t._s(e.product.name))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-auto"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.purchaseProductsRef||{}).data||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" ชิ้น")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.purchaseProductsRef||{}).data||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?t.selectedRows[0].total:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?t.selectedRows[0].total*t.selectedRows[0].discount/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?(t.selectedRows[0].total-t.selectedRows[0].total*t.selectedRows[0].discount/100)*t.selectedRows[0].vat/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s((+t.selectedRows.length>0?t.selectedRows[0].net:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),t._v(" บาท")])])])])]),a("div",{staticClass:"q-pa-sm"}),t._m(1)])]):t._e()])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-3 text-right"},[t._v("หน่วย")]),a("div",{staticClass:"col-3 text-right"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("4160"),a("caad"),a("13d5"),a("b0c0"),a("b680"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ec67")),o=a("1732"),r=a("1c16"),l={name:"PagePurchases",data:function(){return{purchaseColumns:[{name:"id",label:"รหัสซื้อสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"dealerId",label:"ผู้จำหน่าย",field:"dealerId",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:"net",sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],purchaseProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return t.product.id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product.type||{name:void 0}).name},sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product.unit||{name:void 0}).name},sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคา",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"product.cost",label:"ราคาทุน",field:function(t){return t.product.cost},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"total",label:"ราคารวม",field:"total",sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.price",label:"ราคาขาย",field:function(t){return t.product.price},sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"product.quantity",label:"คงเหลือ",field:function(t){return t.product.quantity},sortable:!0,classes:"text-weight-bold",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],purchaseId:void 0,query:"_expand=product&_expand=type&_expand=unit&purchaseId=".concat(this.purchaseId),title:"ซื้อสินค้า",selectedRows:[],lastRow:{},showEditDialog:!1}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])(),this.loadDataDebounce=Object(r["a"])((function(t){t.loadData()}),500)},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("purchases")?this.loadDataDebounce(this.$refs.purchasesRef):t.request.path.split("/").includes("purchaseProducts")&&this.loadDataDebounce(this.$refs.purchaseProductsRef))}},methods:{onInitAddDataPurchases:function(t){t.date=(new Date).toISOString(),t.vat=this.settings.vatPurchase,t.dealerId=this.lastRow.dealerId||0,t.dealer=this.lastRow.dealer},onValidateDataPurchases:function(t,e){return"dealerId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลผู้จำหน่าย":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onAfterLoadDataPurchases:function(t,e){var a=this;this.$axios.get("".concat(this.$global.data.baseUrl,"/purchases?_page=1&_sort=id&_order=desc&_limit=1&_expand=dealer"),{params:{uid:this.UID}}).then((function(t){200===t.status?t.data.length>0?a.lastRow={dealerId:t.data[0].dealerId,dealer:t.data[0].dealer}:a.$axios.get("".concat(a.$global.data.baseUrl,"/dealers?_page=1&_sort=id&_order=desc&_limit=1"),{params:{uid:a.UID}}).then((function(t){200===t.status?a.lastRow=t.data.length>0?{dealerId:t.data[0].id,dealer:t.data[0]}:{}:(console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}),a.lastRow={})})).catch((function(t){console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}),a.lastRow={}})):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}),a.lastRow={})})).catch((function(t){console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}),a.lastRow={}}))},onBeforeUpdateDataPurchases:function(t,e){e.id||(e.date=(new Date).toISOString()),e.net=e.total-e.total*e.discount/100,e.net=e.net+e.net*e.vat/100,e.net=+e.net.toFixed(this.settings.fractionDigits)},onBeforeRemoveDataPurchases:function(t,e){console.log("Event onBeforeRemoveDataPurchases")},onAfterRemoveDataPurchases:function(t,e,a){var s=this;a&&a.__deleted__&&a.__deleted__.purchaseProducts&&a.__deleted__.purchaseProducts.forEach((function(t){s.updateProduct({productId:t.productId,quantity:0,__:{quantity:t.quantity}})}))},onSelectedRows:function(t){this.selectedRows.length>0?(this.purchaseId=+this.selectedRows[0].id,this.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(this.purchaseId),this.title="ซื้อสินค้า ".concat((this.selectedRows[0].dealer||{}).name," [").concat(this.purchaseId,"] (").concat(new Date(this.selectedRows[0].date).toLocaleString(),")"),this.$global.scrollToElement("scrollToThis",1e3,1e3)):(this.purchaseId=void 0,this.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(this.purchaseId),this.title="ซื้อสินค้า",document.activeElement.blur())},onInitAddData:function(t){if(!this.purchaseId)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t),t.quantity=this.settings.quantityPurchase},onInitEditData:function(t){if(!this.purchaseId)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการซื้อสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t)},onValidateData:function(t,e,a){return"productId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===e.name&&t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onBeforeLoadData:function(t,e){var a=this;e.forEach((function(t){return a.initialData(t)}))},onAfterLoadData:function(t,e){document.activeElement.blur()},onBeforeUpdateData:function(t,e){e.purchaseId||(e.purchaseId=this.purchaseId),e["product.cost"]=+(e.price-e.price*e.discount/100).toFixed(this.settings.fractionDigits),e.total=+(e.quantity*e["product.cost"]).toFixed(this.settings.fractionDigits),e["product.price"]||(e["product.price"]=Math.round(e["product.cost"]+e["product.cost"]*this.settings.profit/100))},onAfterUpdateData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},onBeforeRemoveData:function(t,e){e.__.quantity=e.quantity,e.quantity=0},onAfterRemoveData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},initialData:function(t){t.purchaseId||(t.purchaseId=this.purchaseId),t.__=Object.assign({},t.__,{quantity:t.quantity})},updateTotal:function(t){var e=this;this.$axios.get("".concat(this.$global.data.baseUrl,"/purchaseProducts?purchaseId=").concat(this.purchaseId),{params:{uid:this.UID}}).then((function(a){if(200===a.status)if(e.selectedRows.length>0){var s={total:+a.data.reduce((function(t,e){return t+e.total}),0).toFixed(e.settings.fractionDigits)};s.net=s.total-s.total*e.selectedRows[0].discount/100,s.net=s.net+s.net*e.selectedRows[0].vat/100,s.net=+s.net.toFixed(e.settings.fractionDigits),e.$axios.patch("".concat(e.$global.data.baseUrl,"/purchases/").concat(e.purchaseId),s,{params:{uid:e.UID}}).then((function(a){200===a.status?(e.selectedRows[0].total=a.data.total,e.selectedRows[0].net=a.data.net,t.__.quantity=t.quantity,e.$emit("update-cell","purchases",a.data,s)):(console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)}))})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}else e.purchaseId=void 0,e.query="_expand=product&_expand=type&_expand=unit&purchaseId=".concat(e.purchaseId),e.title="ซื้อสินค้า";else console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)})})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},updateProduct:function(t){var e=this,a={id:t.productId,quantityDelta:+t.quantity-+t.__.quantity};t["product.cost"]&&(a.cost=+t["product.cost"].toFixed(this.settings.fractionDigits)),t["product.price"]&&(a.price=+t["product.price"].toFixed(this.settings.fractionDigits)),this.$axios.patch("".concat(this.$global.data.baseUrl,"/products/").concat(t.productId),a,{params:{uid:this.UID}}).then((function(s){200===s.status?(t.product=Object.assign({},s.data),e.$emit("update-cell","products",s.data,a)):(console.error("Error ".concat(s.status,": ").concat(s.statusText)),e.$emit("error","Error ".concat(s.status,": ").concat(s.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(s.status,": ").concat(s.statusText)}))})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},printSelectedItem:function(){var t=this;this.selectedRows.length>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return t.printBorderVisibility(!0)})))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"}}},c=l,d=a("2877"),u=a("2bb1"),p=a("de5e"),f=a("9c40"),m=a("eebe"),g=a.n(m),h=Object(d["a"])(c,s,i,!1,null,null,null);e["a"]=h.exports;g()(h,"components",{QMarkupTable:u["a"],QPageSticky:p["a"],QBtn:f["a"]})},"49de":function(t,e,a){"use strict";(function(t){a("99af"),a("a434"),a("d3b7"),a("ac1f"),a("25f0"),a("5319");var s=a("fbb2"),i=a("10b3"),n=a("7d5b"),o=a("5eaa"),r=a("7079"),l=a("caa3"),c=a("84ba"),d=a("f9ea");e["a"]={name:"MainLayout",data:function(){return{table:"settings",isLoaded:!1,menuModel:!1,panelModel:"menu1",logs:[],showAuthentication:!1,user:"",password:""}},computed:{settings:{get:function(){return this.$store.state.data.settings||{}},set:function(t){this.$store.dispatch("action",{key:"settings",value:t})}}},components:{Sales:s["a"],Purchases:i["a"],Customers:n["a"],Dealers:o["a"],Products:r["a"],PrintBarcode:l["a"],About:c["a"],Settings:d["a"]},mounted:function(){this.$set(this.$global.data,"env",JSON.parse(document.querySelector("#q-env").innerText)),this.$set(this.$global.data,"baseUrl","".concat(this.$global.data.env.NODE_JSON_SERVER,"/api")||!1),this.loadSettings()},methods:{loadSettings:function(){var e=this;console.log("Load Settings"),this.$q.loading.show({message:'<div class="text-h3">'.concat(this.$q.lang.table.loading,"</div>")});var a=this.$q.cookies.get("token")||"";this.$axios.defaults.headers["Set-Cookie"]="token=".concat(a,"; Path=/; Max-Age=86400; SameSite=None; Secure; HttpOnly"),this.$axios.defaults.headers["Content-Type"]="application/json; charset=utf-8",this.$axios.defaults.headers.Authorization=a?"Bearer ".concat(a):"Basic ".concat(t.from(this.user+":"+this.password).toString("base64")),this.$axios.defaults.withCredentials=!0,this.$axios.get("".concat(this.$global.data.baseUrl,"/").concat(this.table,"?_page=1&_sort=id&_order=desc&_limit=1")).then((function(t){200===t.status?t.headers["x-total-count"]>0&&(e.settings=t.data.pop()||{}):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),e.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)})),setTimeout((function(){e.$q.loading.hide(),e.showAuthentication=!1,t.headers["x-token"]&&t.headers["x-token"]!==(e.$q.cookies.get("x-token")||"")&&e.$q.cookies.set("token",t.headers["x-token"],{expires:1}),e.password=void 0,e.$refs.userInputRef&&e.$refs.userInputRef.focus(),e.isLoaded=!0,e.initialWebsocket()}),1e3)})).catch((function(t){t.response&&401===t.response.status||(console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})),setTimeout((function(){e.$q.loading.hide(),e.showAuthentication=!0}),1e3)}))},initialWebsocket:function(){this.$set(this.$global.data,"qualify",void 0),this.$wsClient.open("".concat(this.$global.data.baseUrl.replace(/^http/,"ws").replace("/api","/json-server"))),this.$wsClient.onmessage=function(t,e){var a=JSON.parse(t.data||"{}");"LOG"===a.type?(this.logs.length>=10&&this.logs.splice(-1,1),this.logs.splice(0,0,a.data)):this.$global.data.qualify={request:a.request,response:a.response}}.bind(this)},exit:function(){this.$q.cookies.remove("token"),this.$nextTick((function(){return window.location.reload(!0)}))}}}}).call(this,a("1c35").Buffer)},"4a6c":function(t,e,a){},"5eaa":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"dealersRef",attrs:{"base-url":this.$global.data.baseUrl,table:"dealers",title:"ข้อมูลผู้จำหน่าย",classes:t.settings.classes,columns:t.dealerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o={name:"PageDealers",data:function(){return{dealerColumns:[{name:"id",label:"รหัสผู้จำหน่าย",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อผู้จำหน่าย",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}]}},components:{JsonTable:n["a"]},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("dealers")&&this.loadDataDebounce(this.$refs.dealersRef,t.response.body)}},methods:{onValidateData:function(t,e,a){return"address"===e.name||"telephone"===e.name||"email"===e.name||("text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))}}},r=o,l=a("2877"),c=Object(l["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},7079:function(t,e,a){"use strict";var s=function(){var t=this,e=this,a=e.$createElement,s=e._self._c||a;return s("div",[s("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:e.UID},query:"_expand=type&_expand=unit",table:"products",title:"รายการสินค้า",classes:e.settings.classes,columns:e.productColumns,onValidateData:e.onValidateData,onBeforeUpdateData:e.onBeforeUpdateData,onAfterUpdateData:e.onAfterUpdateData}}),s("JsonTable",{ref:"typesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:e.UID},table:"types",title:"ประเภทสินค้า",classes:e.settings.classes,columns:e.typeColumns},on:{"load-data":function(){},"add-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"update-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"update-cell":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"remove-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()}}}),s("JsonTable",{ref:"unitsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:e.UID},table:"units",title:"หน่วยนับ",classes:e.settings.classes,columns:e.unitColumns},on:{"load-data":function(){},"add-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"update-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"update-cell":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()},"remove-row":function(){return e.loadDataDebounce(t.$refs.productsRef).loadData()}}})],1)},i=[],n=(a("99af"),a("caad"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("4d90"),a("1276"),a("ec67")),o=a("1732"),r=a("1c16"),l={name:"PageProducts",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"รหัสบาร์โค้ด",field:"barcode",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวนคงเหลือ",field:"quantity",sortable:!0,classes:"text-green-10 text-weight-bold",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],typeColumns:[{name:"id",label:"รหัสประเภทสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ประเภทสินค้า",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],unitColumns:[{name:"id",label:"รหัสหน่วยนับ",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"หน่วยนับ",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"detail",label:"รายละเอียด",field:"detail",sortable:!0,classes:"text-green-10",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}]}},components:{JsonTable:n["a"]},created:function(){this.UID=Object(o["a"])(),this.loadDataDebounce=Object(r["a"])((function(t){t.loadData()}),500)},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("products")?this.loadDataDebounce(this.$refs.productsRef):t.request.path.split("/").includes("types")?this.loadDataDebounce(this.$refs.typesRef):t.request.path.split("/").includes("units")&&this.loadDataDebounce(this.$refs.unitsRef))}},methods:{onValidateData:function(t,e,a){return"barcode"===e.name||("typeId"===e.name||"unitId"===e.name||"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))},onBeforeUpdateData:function(t,e){e.price||(e.price=Math.round(e.cost+e.cost*this.settings.profit/100))},onAfterUpdateData:function(t,e,a){var s=this;if(!e.barcode){var i={id:e.id,barcode:"".concat(e.id).padStart(13,"0")};e.barcode=i.barcode,this.$axios.patch("".concat(this.$global.data.baseUrl,"/products/").concat(e.id),i,{params:{uid:this.UID}}).then((function(t){200===t.status?(e.product=Object.assign({},t.data),s.$emit("update-cell","products",t.data,i)):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),s.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),s.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}))})).catch((function(t){console.error(t),s.$emit("error","Error ".concat(t.message)),s.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}}}},c=l,d=a("2877"),u=Object(d["a"])(c,s,i,!1,null,null,null);e["a"]=u.exports},"713b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{attrs:{view:"hHh lpR fFf"}},[a("q-header",{staticClass:"bg-primary text-white",attrs:{elevated:"","height-hint":"98"}},[a("q-toolbar",{staticClass:"bg-primary glossy text-white"},[a("q-fab",{attrs:{dense:"",flat:"",round:"",square:"",direction:"down","vertical-actions-align":"left",icon:"menu"},model:{value:t.menuModel,callback:function(e){t.menuModel=e},expression:"menuModel"}},[a("q-fab-action",{attrs:{glossy:"",square:"",color:"light-blue",label:"ขายสินค้า","label-position":"right",icon:"point_of_sale"},on:{click:function(e){t.panelModel="menu1"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"cyan",label:"ซื้อสินค้า","label-position":"right",icon:"shopping_cart"},on:{click:function(e){t.panelModel="menu2"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"teal",label:"ข้อมูลลูกค้า","label-position":"right",icon:"people"},on:{click:function(e){t.panelModel="menu3"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"secondary",label:"ข้อมูลผู้จำหน่าย","label-position":"right",icon:"people_outline"},on:{click:function(e){t.panelModel="menu4"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"positive",label:"รายการสินค้า","label-position":"right",icon:"widgets"},on:{click:function(e){t.panelModel="menu5"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"accent",label:"พิมพ์บาร์โค้ด","label-position":"right",icon:"qr_code"},on:{click:function(e){t.panelModel="menu6"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"pink",label:"ข้อมูลกิจการ","label-position":"right",icon:"account_box"},on:{click:function(e){t.panelModel="menu7"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"negative",label:"การตั้งค่า","label-position":"right",icon:"settings"},on:{click:function(e){t.panelModel="menu8"}}}),a("q-fab-action",{attrs:{glossy:"",square:"",color:"deep-orange",label:"ปิดระบบ","label-position":"right",icon:"power_settings_new"},on:{click:function(e){return t.exit()}}})],1),a("q-toolbar-title",[a("q-avatar",[a("img",{attrs:{src:"quasar-logo.svg",alt:""}})]),t._v("\n        "+t._s(t.settings.name)+"\n      ")],1),a("q-btn-group",{attrs:{push:""}},[a("q-btn",{attrs:{glossy:"",color:"light-blue",icon:"point_of_sale"},on:{click:function(e){t.panelModel="menu1"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-light-blue","content-style":"font-size: 14px;"}},[t._v("\n            ขายสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"cyan",icon:"shopping_cart"},on:{click:function(e){t.panelModel="menu2"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-cyan","content-style":"font-size: 14px;"}},[t._v("\n            ซื้อสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"teal",icon:"people"},on:{click:function(e){t.panelModel="menu3"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-teal","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลลูกค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"secondary",icon:"people_outline"},on:{click:function(e){t.panelModel="menu4"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-secondary","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลผู้จำหน่าย\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"positive",icon:"widgets"},on:{click:function(e){t.panelModel="menu5"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-positive","content-style":"font-size: 14px;"}},[t._v("\n            รายการสินค้า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"accent",icon:"qr_code"},on:{click:function(e){t.panelModel="menu6"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-accent","content-style":"font-size: 14px;"}},[t._v("\n            พิมพ์บาร์โค้ด\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"pink",icon:"account_box"},on:{click:function(e){t.panelModel="menu7"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-pink","content-style":"font-size: 14px;"}},[t._v("\n            ข้อมูลกิจการ\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"negative",icon:"settings"},on:{click:function(e){t.panelModel="menu8"}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-negative","content-style":"font-size: 14px;"}},[t._v("\n            การตั้งค่า\n          ")])],1),a("q-btn",{attrs:{glossy:"",color:"deep-orange",icon:"power_settings_new"},on:{click:function(e){return t.exit()}}},[a("q-tooltip",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale","content-class":"bg-deep-orange","content-style":"font-size: 14px;"}},[t._v("\n            ปิดระบบ\n          ")])],1)],1)],1)],1),a("q-page-container",[a("keep-alive",[t.isLoaded?a("q-tab-panels",{attrs:{animated:"","keep-alive":""},model:{value:t.panelModel,callback:function(e){t.panelModel=e},expression:"panelModel"}},[a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu1"}},[a("keep-alive",[a("Sales")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu2"}},[a("keep-alive",[a("Purchases")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu3"}},[a("keep-alive",[a("Customers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu4"}},[a("keep-alive",[a("Dealers")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu5"}},[a("keep-alive",[a("Products")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu6"}},[a("keep-alive",[a("PrintBarcode")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu7"}},[a("keep-alive",[a("About")],1)],1),a("q-tab-panel",{staticClass:"q-pa-none",attrs:{name:"menu8"}},[a("keep-alive",[a("Settings")],1)],1)],1):t._e()],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:t.showAuthentication,callback:function(e){t.showAuthentication=e},expression:"showAuthentication"}},[a("q-card",{staticStyle:{background:"radial-gradient(circle at center, rgba(255, 255, 255, 1.0), rgba(80, 160, 240, 0.8))"}},[a("q-card-section",{staticClass:"q-pa-none",attrs:{align:"evenly"}},[a("div",{staticClass:"q-pb-none",attrs:{align:"center"}},[a("img",{attrs:{src:"logo-color.png",width:"300"}})])]),a("q-card-section",[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"500px"}},[a("q-input",{ref:"userInputRef",attrs:{type:"email",autofocus:"",clearable:"",counter:"",debounce:"200",label:"อีเมล์","stack-label":!0,"input-class":"text-left text-accent text-h4",rules:[function(t){return t&&t.length>0&&t.includes("@")||"ยังไม่ได้กำหนดข้อมูล อีเมล์"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.$refs.passwordInputRef.focus()}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.user=void 0,t.$nextTick((function(){return t.$refs.userInputRef.resetValidation()}))}},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}),a("q-input",{ref:"passwordInputRef",attrs:{type:"password",clearable:"",counter:"",debounce:"200",label:"รหัสผ่าน","stack-label":!0,"input-class":"text-left text-accent text-h4",rules:[function(t){return!t||t&&t.length>=0||"ยังไม่ได้กำหนดข้อมูล รหัสผ่าน"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0)&&t.loadSettings()}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()},clear:function(){return t.password=void 0,t.$nextTick((function(){return t.$refs.passwordInputRef.resetValidation()}))}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)]),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{attrs:{color:"primary",label:"เปิดใช้งาน",disable:!(t.user&&t.user.length>0&&(!t.password||t.password&&t.password.length>=0))},on:{click:function(e,a){return t.loadSettings()}}})],1)],1)],1)],1)},i=[],n=a("49de"),o=n["a"],r=a("2877"),l=a("4d5a"),c=a("e359"),d=a("65c6"),u=a("c294"),p=a("72db"),f=a("6ac5"),m=a("cb32"),g=a("e7a9"),h=a("9c40"),b=a("05c0"),y=a("09e3"),x=a("adad"),v=a("823b"),_=a("7ff0"),w=a("24e8"),q=a("f09f"),D=a("a370"),C=a("27f9"),$=a("4b7e"),I=a("eebe"),R=a.n(I),k=Object(r["a"])(o,s,i,!1,null,null,null);e["default"]=k.exports;R()(k,"components",{QLayout:l["a"],QHeader:c["a"],QToolbar:d["a"],QFab:u["a"],QFabAction:p["a"],QToolbarTitle:f["a"],QAvatar:m["a"],QBtnGroup:g["a"],QBtn:h["a"],QTooltip:b["a"],QPageContainer:y["a"],QTabPanels:x["a"],QTabPanel:v["a"],QFooter:_["a"],QDialog:w["a"],QCard:q["a"],QCardSection:D["a"],QInput:C["a"],QCardActions:$["a"]})},"7d5b":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"customersRef",attrs:{"base-url":this.$global.data.baseUrl,table:"customers",title:"ข้อมูลลูกค้า",classes:t.settings.classes,columns:t.customerColumns,onValidateData:t.onValidateData}})],1)},i=[],n=(a("caad"),a("b0c0"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o={name:"PageCustomers",data:function(){return{customerColumns:[{name:"id",label:"รหัสลูกค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อลูกค้า",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}]}},components:{JsonTable:n["a"]},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("customers")&&this.loadDataDebounce(this.$refs.customersRef,t.response.body)}},methods:{onValidateData:function(t,e,a){return"address"===e.name||"telephone"===e.name||"email"===e.name||("text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล"))}}},r=o,l=a("2877"),c=Object(l["a"])(r,s,i,!1,null,null,null);e["a"]=c.exports},"84ba":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"settingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"ข้อมูลกิจการ","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:t.settings.classes,columns:t.aboutColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}})],1)},i=[],n=(a("caad"),a("cca6"),a("ac1f"),a("2532"),a("38cf"),a("1276"),a("ec67")),o=a("1732"),r=a("1c16"),l={name:"PageAbout",data:function(){return{aboutColumns:[{name:"id",label:"รหัสกิจการ",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อกิจการ",field:"name",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"address",label:"สถานที่ตั้ง - ที่อยู่",field:"address",sortable:!0,classes:"text-green-10",edit:{type:"textarea",inputClass:"",prefix:"",suffix:""}},{name:"telephone",label:"หมายเลขโทรศัพท์",field:"telephone",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"email",label:"อีเมล์",field:"email",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"password",label:"รหัสผ่าน",field:function(t){return"•".repeat((t.password||"").length)},sortable:!1,classes:"text-green-10",edit:{type:"password",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}]}},components:{JsonTable:n["a"]},created:function(){var t=this;this.UID=Object(o["a"])(),this.loadDataDebounce=Object(r["a"])((function(e,a){e.loadData(),a&&t.updateHandler("",a)}),500)},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("settings")&&this.loadDataDebounce(this.$refs.settingsRef,t.response.body)}},methods:{updateHandler:function(t,e){this.$store.dispatch("action",{key:"settings",value:Object.assign({},this.settings,e)}),"settings"===t&&e&&"".concat(e.password||"")!=="".concat(this.$q.cookies.get("token")||"")&&this.$q.cookies.set("token","".concat(e.password||""),{expires:1})}}},c=l,d=a("2877"),u=Object(d["a"])(c,s,i,!1,null,null,null);e["a"]=u.exports},"8cea":function(t,e,a){"use strict";a("4a6c")},"993b":function(t,e,a){},a9bc:function(t,e,a){"use strict";a("993b")},caa3:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"productsRef",attrs:{"base-url":this.$global.data.baseUrl,query:"_expand=type&_expand=unit",table:"products",title:"รายการสินค้า",classes:t.settings.classes,columns:t.productColumns.filter((function(t){return"printsPerItem"!==t.name})),hideAddButton:"",hideEditButton:"",hideRemoveButton:""},scopedSlots:t._u([{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"add",color:"orange",size:"xs"},on:{click:function(){return t.addSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มรายการพิมพ์บาร์โค้ด")])],1)]}}])}),a("JsonTable",{attrs:{title:"รายการพิมพ์บาร์โค้ด "+t.selectedRows.length+" รายการ",classes:t.settings.classes,columns:t.productColumns,hideSearchButton:"",hideRefreshButton:"",hideAddButton:"",hideEditButton:"",hideRemoveButton:"",hidePagination:""},on:{"update-cell":function(t,e){return e.hasRender=!1}},scopedSlots:t._u([{key:"header",fn:function(e){var s=e.props;return[a("q-checkbox",{attrs:{label:"แสดงชื่อสินค้า"},model:{value:t.displayName,callback:function(e){t.displayName=e},expression:"displayName"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงราคาสินค้า"},model:{value:t.displayPrice,callback:function(e){t.displayPrice=e},expression:"displayPrice"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-checkbox",{attrs:{label:"แสดงรหัสบาร์โค้ด"},model:{value:t.displayBarcode,callback:function(e){t.displayBarcode=e},expression:"displayBarcode"}}),a("q-space",{staticClass:"q-px-sm",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความกว้างของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeWidth=150}},model:{value:t.barcodeWidth,callback:function(e){t.barcodeWidth=t._n(e)},expression:"barcodeWidth"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความกว้างของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"ความสูงของบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=200||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.barcodeHeight=50}},model:{value:t.barcodeHeight,callback:function(e){t.barcodeHeight=t._n(e)},expression:"barcodeHeight"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("ความสูงของบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",debounce:"1000",label:"จำนวนบาร์โค้ด","input-class":"text-center",rules:[function(t){return t>0&&t<=100||"ข้อมูลต้องมีค่ามากกว่า 0"}]},on:{focus:t.selectOnFocus,clear:function(){return t.printsPerItem=1}},model:{value:t.printsPerItem,callback:function(e){t.printsPerItem=t._n(e)},expression:"printsPerItem"}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("จำนวนบาร์โค้ด")])],1),a("q-space",{staticClass:"q-px-md",attrs:{vertical:""}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.printAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-accent"}},[t._v("พิมพ์บาร์โค้ด")])],1),a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"clear",color:"red",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.removeAllSelectedItem(s)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการทั้งหมด")])],1)]}},{key:"body",fn:function(e){var s=e.props;return[a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"remove",color:"red",size:"xs"},on:{click:function(){return t.removeSelectedItem(s.row)}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบรายการพิมพ์บาร์โค้ด")])],1)]}}]),model:{value:t.selectedRows,callback:function(e){t.selectedRows=e},expression:"selectedRows"}}),a("q-page-sticky",{attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0},on:{click:function(){return t.printAllSelectedItem({})}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[t.selectedRows.length>0?a("div",{staticClass:"q-pa-md row wrap justify-start items-start content-start",staticStyle:{width:"790px",border:"1px solid black"},attrs:{id:"printBorder"}},t._l(t.barcodeItems,(function(e){return a("div",{key:e.key,staticStyle:{overflow:"auto"}},[t.displayName?a("div",{staticClass:"text-center text-bold"},[t._v(t._s(e.name)+"\n        ")]):t._e(),t.displayPrice?a("div",{staticClass:"text-center text-bold",staticStyle:{"font-size":"larger"}},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" "+t._s("บาท")+"\n        ")]):t._e(),a("svg",{class:"class-"+e.id})])})),0):t._e()])],1)},i=[],n=(a("99af"),a("c740"),a("4160"),a("caad"),a("13d5"),a("a434"),a("b0c0"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("159b"),a("ec67")),o=a("a57a"),r=a.n(o),l={name:"PagePrintBarcode",data:function(){return{productColumns:[{name:"id",label:"รหัสสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"typeId",label:"ประเภทสินค้า",field:"typeId",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"unitId",label:"หน่วยนับ",field:"unitId",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"barcode",label:"รหัสบาร์โค้ด",field:"barcode",sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"name",label:"ชื่อสินค้า",field:"name",sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cost",label:"ราคาทุน",field:"cost",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"price",label:"ราคาขาย",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวนคงเหลือ",field:"quantity",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"printsPerItem",label:"จำนวนบาร์โค้ด",field:"printsPerItem",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],selectedRows:[],displayName:!1,displayPrice:!1,displayBarcode:!1,barcodeWidth:150,barcodeHeight:50,printsPerItem:1}},components:{JsonTable:n["a"]},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}},barcodeItems:function(){var t=this;return this.selectedRows.reduce((function(e,a){for(var s=1;s<=a.printsPerItem;s++)e.push(Object.assign({},a,{key:"".concat(a.id,"-").concat(s)}));return t.renderBarcode(),e}),[])}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("products")&&this.loadDataDebounce(this.$refs.productsRef,t.response.body)},displayBarcode:function(t,e){this.renderBarcode(!0)},barcodeWidth:function(t,e){this.setBarcodeWidth()},barcodeHeight:function(t,e){this.renderBarcode(!0)}},methods:{addSelectedItem:function(t){if(t){var e=this.selectedRows.findIndex((function(e){return e.id===t.id}));e>=0?(this.selectedRows.splice(e,1,t),t.printsPerItem=(t.printsPerItem||0)+this.printsPerItem):(this.selectedRows.splice(this.selectedRows.length,0,t),this.$set(t,"printsPerItem",this.printsPerItem)),t.hasRender=!1}},removeSelectedItem:function(t){if(t){var e=this.selectedRows.findIndex((function(e){return e.id===t.id}));e>=0&&this.selectedRows.splice(e,1)}},removeAllSelectedItem:function(t){t&&this.selectedRows.splice(0,this.selectedRows.length)},printAllSelectedItem:function(t){var e=this;t&&this.selectedRows.length>0&&(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return e.printBorderVisibility(!0)})))},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},setBarcodeWidth:function(){var t=this;this.$nextTick((function(){document.querySelectorAll("svg[class^=class-]").forEach((function(e){e.setAttribute("width",t.barcodeWidth)}))}))},renderBarcode:function(t){var e=this;this.$nextTick((function(){e.selectedRows.length>0&&(e.selectedRows.forEach((function(a){(!0===t||!a.hasRender&&(a.hasRender=!0))&&r()(".class-".concat(a.id),a.barcode,{format:"CODE128",font:"TH Sarabun New",fontOptions:"bold",fontSize:20,margin:10,textMargin:2,width:2,height:e.barcodeHeight,displayValue:e.displayBarcode}).render()})),e.setBarcodeWidth())}))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"}}},c=l,d=a("2877"),u=a("9c40"),p=a("05c0"),f=a("8f8e"),m=a("2c91"),g=a("27f9"),h=a("de5e"),b=a("eebe"),y=a.n(b),x=Object(d["a"])(c,s,i,!1,null,null,null);e["a"]=x.exports;y()(x,"components",{QBtn:u["a"],QTooltip:p["a"],QCheckbox:f["a"],QSpace:m["a"],QInput:g["a"],QPageSticky:h["a"]})},ec67:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-md"},[a("q-table",{class:[t.classes||"",t.showSelectRows?"sticky-column-table":""],attrs:{"binary-state-sort":"","row-key":"id",selection:"single",title:t.title,data:t.data,pagination:t.pagination,loading:t.loading,columns:t.columns,filter:t.filter,"hide-pagination":t.hidePagination,selected:t.selected,"title-class":[t.classes||"","text-bold"]},on:{"update:title":function(e){t.title=e},"update:data":function(e){t.data=e},"update:pagination":function(e){t.pagination=e},"update:loading":function(e){t.loading=e},"update:columns":function(e){t.columns=e},"update:filter":function(e){t.filter=e},"update:hidePagination":function(e){t.hidePagination=e},"update:hide-pagination":function(e){t.hidePagination=e},"update:selected":[function(e){t.selected=e},function(e){return t.selectItem(e)}],request:function(e){return t.loadData(e)}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[t.hideSearchButton?t._e():a("q-input",{attrs:{autofocus:"",dense:"",clearable:"",counter:"",debounce:"1000",placeholder:"ค้นหา"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}}),a("q-tooltip",{attrs:{"content-class":"bg-purple"}},[t._v("ค้นหาข้อมูล")])]},proxy:!0}],null,!0),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),t.hideRefreshButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"refresh",color:"green",size:"xs"},on:{click:function(e){return e.stopPropagation(),function(){return t.loadData()}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-green"}},[t._v("รีเฟรชข้อมูล")])],1),t.hideAddButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"add",color:"orange",size:"xs"},on:{click:function(e){return e.stopPropagation(),function(){return t.addItem()}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-orange"}},[t._v("เพิ่มข้อมูล")])],1),t._t("header",null,{props:e})]}},{key:"header",fn:function(e){return[a("q-tr",{attrs:{props:e}},[t.showSelectRows?a("q-th",{class:[t.classes||"","bg-grey-5"],attrs:{"auto-width":!0}}):t._e(),t._l(e.cols,(function(s){return a("q-th",{key:s.name,class:[s.headerClasses||"",t.classes||"","text-bold bg-grey-4"],attrs:{props:e,"auto-width":!0}},[a("b",{class:[s.headerClasses||"",t.classes||"","text-bold bg-grey-4"]},[t._v("\n            "+t._s(s.label)+"\n          ")])])})),a("q-dialog",{attrs:{persistent:""},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",{staticClass:"q-px-xl"},t._l(e.cols,(function(e){return a("div",{key:e.name},["text"===e.edit.type||"textarea"===e.edit.type||"password"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{type:e.edit.type,dense:"",clearable:"",counter:"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,a)},expression:"editedItem[col.name]"}})],1):t._e(),"number"===e.edit.type||"decimal"===e.edit.type?a("div",[e.name.endsWith("Id")?a("div",[e.edit.readonly&&t.editedItem.id?t._e():a("q-select",{attrs:{dense:"",clearable:"",counter:"",label:e.label,readonly:e.edit.readonly&&!!t.editedItem.id,"input-class":e.edit.inputClass||"text-right",prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}],options:t.filterOptions[e.name.slice(0,-2)+"s"],"option-label":function(a){return(("object"!==typeof a?a=t.editedItem[e.name.slice(0,-2)]:a)||{name:""}).name},"emit-value":"","map-options":"","option-value":"id","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(a,s,i){return t.filterFnAutoSelect(a||(t.editedItem[e.name.slice(0,-2)]||{name:""}).name,s,i,e.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn,input:function(a){return t.editedItem[""+e.name.slice(0,-2)]=t.filterOptions[e.name.slice(0,-2)+"s"].find((function(t){return t.id===a}))}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,t._n(a))},expression:"editedItem[col.name]"}})],1):a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{type:"number",dense:"",clearable:"",counter:"",label:e.label,readonly:e.edit.readonly,"input-class":e.edit.inputClass||"text-right",prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{focus:function(e){return t.selectOnFocus(e)}},model:{value:t.editedItem[e.name],callback:function(a){t.$set(t.editedItem,e.name,t._n(a))},expression:"editedItem[col.name]"}})],1)]):t._e(),"datetime"===e.edit.type?a("div",[e.edit.readonly?t._e():a("q-input",{attrs:{value:t.bindDateTime(t.editedItem[e.name]),type:"datetime-local",dense:"",clearable:"",counter:"",label:e.label,"stack-label":!0,readonly:e.edit.readonly,"input-class":e.edit.inputClass,prefix:e.edit.prefix,suffix:e.edit.suffix,rules:[function(a){return t.validateCell(a,e,t.editedItem)}]},on:{input:function(a){return t.editedItem[e.name]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)}}})],1):t._e()])})),0),a("q-card-actions",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(e){return e.stopPropagation(),function(){return t.dialogVisible=!1}()}}}),a("q-btn",{attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:!0!==t.validateRow(t.editedItem)},on:{click:function(e){return e.stopPropagation(),function(){return t.updateRow(t.editedItem)}()}}})],1)],1)],1)],2)]}},{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[t.showSelectRows?a("q-td",{attrs:{"auto-width":!0}},[a("q-checkbox",{staticClass:"auto-width",model:{value:e.selected,callback:function(a){t.$set(e,"selected",a)},expression:"props.selected"}})],1):t._e(),t._l(e.cols,(function(s){return a("q-td",{key:s.name,class:[s.classes||"",t.classes||""],attrs:{props:e,"auto-width":!0}},[a("div",{class:[s.classes||"",t.classes||""]},["text"===s.edit.type||"textarea"===s.edit.type||"password"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-separator"),a("q-input",{attrs:{type:s.edit.type,autofocus:"",dense:"",clearable:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{focus:function(e){return t.selectOnFocus(e)},keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",a)},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row)||e.row["__"+s.name+"__"]===e.row[s.name]},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"number"===s.edit.type||"decimal"===s.edit.type?a("div",[s.name.endsWith("Id")?a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-separator"),a("q-select",{attrs:{autofocus:"",dense:"",clearable:"",counter:"",label:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right",prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}],options:t.filterOptions[s.name.slice(0,-2)+"s"],"option-label":function(t){return(("object"!==typeof t?t=e.row[s.name.slice(0,-2)]:t)||{name:""}).name},"emit-value":"","map-options":"","option-value":"id","use-input":"","fill-input":"","hide-selected":""},on:{filter:function(a,i,n){return t.filterFnAutoSelect(a||(e.row[s.name.slice(0,-2)]||{name:""}).name,i,n,s.name.slice(0,-2)+"s")},"filter-abort":t.abortFilterFn},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row)||e.row["__"+s.name+"__"]===e.row[s.name]},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],e.row[s.name.slice(0,-2)]=t.filterOptions[s.name.slice(0,-2)+"s"].find((function(t){return t.id===e.row[s.name]})),t.updateCell(e.row,s)}()}}})],1)],1)])],1):a("div",[t._v("\n                "+t._s(t.getCellDisplay(e.row,s))+"\n\n                "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                      "+t._s("แก้ไข"+s.label)+"\n                    ")]),a("q-separator"),a("q-input",{attrs:{type:"number",autofocus:"",dense:"",clearable:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass||"text-right",prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{focus:function(e){return t.selectOnFocus(e)}},model:{value:e.row["__"+s.name+"__"],callback:function(a){t.$set(e.row,"__"+s.name+"__",t._n(a))},expression:"props.row[`__${col.name}__`]"}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row)||e.row["__"+s.name+"__"]===e.row[s.name]},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1)]):t._e(),"datetime"===s.edit.type?a("div",[t._v("\n              "+t._s(t.getCellDisplay(e.row,s))+"\n\n              "),s.edit.readonly?t._e():a("q-popup-proxy",{on:{"before-show":function(a){return"undefined"===typeof e.row["__"+s.name+"__"]&&t.$set(e.row,"__"+s.name+"__",e.row[s.name])},hide:function(t){return delete e.row["__"+s.name+"__"]}}},[a("div",{staticClass:"q-pa-md",staticStyle:{"min-width":"300px"}},[a("div",{staticClass:"q-pb-md text-center text-h6 text-accent"},[t._v("\n                    "+t._s("แก้ไข"+s.label)+"\n                  ")]),a("q-separator"),a("q-input",{attrs:{value:t.bindDateTime(e.row["__"+s.name+"__"]),type:"datetime-local",autofocus:"",dense:"",clearable:"",counter:"",hint:s.label,readonly:s.edit.readonly,"input-class":s.edit.inputClass,prefix:s.edit.prefix,suffix:s.edit.suffix,rules:[function(a){return t.validateCell(a,s,e.row)}]},on:{input:function(a){return e.row["__"+s.name+"__"]=t.eventDateTime(a)},focus:function(e){return t.selectOnFocus(e)}}}),a("q-space",{staticClass:"q-pb-md"}),a("div",{staticClass:"q-pa-md q-gutter-md row justify-evenly"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"primary",label:"ยกเลิก"},on:{click:function(t){t.stopPropagation()}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{glossy:"",color:"secondary",label:"บันทึก",disable:!0!==t.validateCell(e.row["__"+s.name+"__"],s,e.row)||e.row["__"+s.name+"__"]===e.row[s.name]},on:{click:function(a){return a.stopPropagation(),function(){return e.row[s.name]=e.row["__"+s.name+"__"],t.updateCell(e.row,s)}()}}})],1)],1)])],1):"actions"===s.name||"actions"===s.edit.type?a("div",[t.hideEditButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"edit",color:"blue",size:"xs"},on:{click:function(a){return a.stopPropagation(),function(){return t.editItem(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-blue"}},[t._v("แก้ไขข้อมูล")])],1),t.hideRemoveButton?t._e():a("q-btn",{staticClass:"q-ma-xs",attrs:{glossy:"",round:"",icon:"remove",color:"red",size:"xs"},on:{click:function(a){return a.stopPropagation(),function(){return t.removeItem(e.row)}()}}},[a("q-tooltip",{attrs:{"content-class":"bg-red"}},[t._v("ลบข้อมูล")])],1),t._t("body",null,{props:e})],2):t._e()])])}))],2)]}},{key:"pagination",fn:function(e){return[a("q-pagination",{attrs:{max:t.pagesNumber,"max-pages":t.pagination.rowsPerPage,"direction-links":!0,"boundary-links":!0,"icon-first":"skip_previous","icon-last":"skip_next","icon-prev":"fast_rewind","icon-next":"fast_forward",size:"md"},on:{input:function(e){return t.loadData()}},model:{value:t.pagination.page,callback:function(e){t.$set(t.pagination,"page",e)},expression:"pagination.page"}}),t._v("\n\n      "+t._s(t.$q.lang.table.allRows+": "+t.pagination.rowsNumber)+"\n\n      "),t._t("footer",null,{props:e})]}}],null,!0)})],1)},i=[],n=(a("99af"),a("a623"),a("4de4"),a("7db0"),a("caad"),a("fb6a"),a("a434"),a("b0c0"),a("a9e3"),a("cca6"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("8a79"),a("2532"),a("5319"),a("1276"),a("2ca0"),a("498a"),a("9523")),o=a.n(n),r=a("7037"),l=a.n(r),c=a("6374"),d=a.n(c),u={name:"JsonTable",model:{prop:"rows",event:"rows"},props:{title:{type:String,default:""},baseUrl:{type:String,default:""},query:{type:String,default:""},table:{type:String,default:""},classes:{type:String,default:""},params:{type:Object,default:function(){}},columns:{type:Array,default:function(){return[]}},rows:{type:Array,default:function(){return[]}},rowsPerPage:{type:Number,default:5},hidePagination:{type:Boolean,default:!1},hideSearchButton:{type:Boolean,default:!1},hideRefreshButton:{type:Boolean,default:!1},hideAddButton:{type:Boolean,default:!1},hideEditButton:{type:Boolean,default:!1},hideRemoveButton:{type:Boolean,default:!1},showEditDialog:{type:Boolean,default:!1},showSelectRows:{type:Boolean,default:!1},onInitAddData:{type:Function,default:function(){}},onInitEditData:{type:Function,default:function(){}},onValidateData:{type:Function,default:function(){}},onBeforeLoadData:{type:Function,default:function(){}},onAfterLoadData:{type:Function,default:function(){}},onBeforeUpdateData:{type:Function,default:function(){}},onAfterUpdateData:{type:Function,default:function(){}},onBeforeRemoveData:{type:Function,default:function(){}},onAfterRemoveData:{type:Function,default:function(){}}},data:function(){return{loading:!1,dialogVisible:!1,isNewItem:!1,filter:"",data:[],selected:[],pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:this.rowsPerPage,rowsNumber:0},filterOptions:{},defaultItem:{},editedItem:{},dialogPos:{x:0,y:0}}},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}},pagesNumber:function(){return this.pagination.rowsPerPage>0?Math.ceil(this.pagination.rowsNumber/this.pagination.rowsPerPage):1},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{query:function(t,e){this.loadData()},rows:function(t,e){this.onBeforeLoadData("",t)||(this.data=t,this.pagination.rowsNumber=this.data.length,this.pagination.page=1,this.pagination.rowsPerPage=this.rowsPerPage,this.pagination.sortBy=void 0,this.pagination.descending=void 0,this.$emit("update:rows","",this.data),this.onAfterLoadData("",this.data)||this.$emit("load-data",this.table,this.data))},rowsPerPage:function(t,e){this.pagination.rowsPerPage=t},hidePagination:function(t,e){t?this.pagination.rowsPerPage=0:this.pagination.rowsPerPage<=0&&(this.pagination.rowsPerPage=5)},showEditDialog:function(t,e){this.dialogVisible=t},loading:function(t,e){t?this.$q.loading.show():this.$q.loading.hide()}},mounted:function(){this.loadData()},methods:{loadData:function(t,e){var a=this;if(this.baseUrl&&this.table){var s=Object.assign({},{pagination:this.pagination,filter:this.filter},t),i=s.pagination,n=i.page,o=i.rowsPerPage,r=i.sortBy,c=i.descending,u=s.filter,p="".concat(this.baseUrl,"/").concat(this.table,"?_page=").concat(n,"&_sort=").concat(r,"&_order=").concat(c?"desc":"asc").concat(o&&o>0?"&_limit="+o:"").concat(u&&u.trim()?"&q="+u.trim():"").concat(this.query&&this.query.trim()?"&"+this.query.trim():"");this.loading=!0,this.$axios.get(p,{params:this.params}).then((function(t){if(a.loading=!1,200===t.status){if(a.onBeforeLoadData(p,t.data))return;if(a.data=t.data,a.pagination.rowsNumber=t.headers["x-total-count"],a.pagination.page=n,a.pagination.rowsPerPage=o,a.pagination.sortBy=r,a.pagination.descending=c,a.$emit("update:rows","",a.data),a.onAfterLoadData(p,a.data))return;var s;if(a.$emit("load-data",a.table,a.data),a.showSelectRows)e&&(s=a.data.find((function(t){return t.id===e}))),s?a.selected.splice(0,a.selected.length,s):(a.selected.length>0&&(s=a.data.find((function(t){return t.id===a.selected[0].id}))),s?a.selected.splice(0,a.selected.length,s):a.selected.length>0&&a.selected.splice(0,a.selected.length)),a.selectItem(s?[s]:[]);a.defaultItem={};var i,u=d()(a.columns);try{for(u.s();!(i=u.n()).done;){var f=i.value;"object"===l()(f)&&"string"===typeof f.name&&"object"===l()(f.edit)&&"actions"!==f.name&&("text"===f.edit.type||"textarea"===f.edit.type||"password"===f.edit.type||"datetime"===f.edit.type?a.defaultItem[f.name]="":"number"!==f.edit.type&&"decimal"!==f.edit.type||(a.defaultItem[f.name]=0))}}catch(m){u.e(m)}finally{u.f()}}else console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)})})).catch((function(t){console.error(t),a.loading=!1,a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}else this.$emit("load-data",this.table,this.data)},selectItem:function(t){this.showSelectRows&&this.$emit("update:selected",this.selected)},addItem:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.isNewItem=!0,this.editedItem=Object.assign({},this.defaultItem),!this.onInitAddData(this.editedItem)&&t&&(this.dialogVisible=!0),this.editedItem},editItem:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.isNewItem=!1,this.editedItem=Object.assign({},this.defaultItem,t),!this.onInitEditData(this.editedItem)&&e&&(this.dialogVisible=!0),this.editedItem},removeItem:function(t){var e=this;this.baseUrl&&this.table?this.$q.dialog({title:"ยืนยันการลบข้อมูล",message:"กรุณายืนยันเพื่อความแน่ใจในการลบข้อมูล ".concat(t.name||"รหัส "+t.id," ?"),ok:{glossy:!0,push:!0,color:"negative",label:"ยืนยันการลบ"},cancel:{glossy:!0,push:!0,color:"primary",label:"ยกเลิก"},focus:"cancel"}).onOk((function(){var a="".concat(e.baseUrl,"/").concat(e.table,"/").concat(t.id);e.onBeforeRemoveData(a,t)||(e.loading=!0,e.$axios.delete(a,{params:e.params}).then((function(s){if(e.loading=!1,200===s.status){if(e.onAfterRemoveData(a,t,s.data))return;e.loadData(),e.$emit("remove-row",e.table,s.data),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้ลบเรียบร้อยแล้ว")})}else console.error("Error ".concat(s.status,": ").concat(s.statusText)),e.$emit("error","Error ".concat(s.status,": ").concat(s.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(s.status,": ").concat(s.statusText)})})).catch((function(t){console.error(t),e.loading=!1,e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})})))})):this.$emit("remove-row",this.table,t)},updateRow:function(t){var e=this;if(this.baseUrl&&this.table){if(!0===this.validateRow(t)){var a=function(a){var s=e.columns.find((function(t){return t.name===a}));s&&s.edit&&("number"!==s.edit.type&&"decimal"!==s.edit.type||isNaN(t[s.name])||(t[s.name]=+(t[s.name]||0)))};for(var s in t)a(s);if(this.isNewItem){delete t.id;var i="".concat(this.baseUrl,"/").concat(this.table);if(this.onBeforeUpdateData(i,t))return;this.loading=!0,this.$axios.post(i,this.shallowCopy(t),{params:this.params}).then((function(a){if(e.loading=!1,201===a.status){if(a.data.id&&!t.id&&e.$set(t,"id",a.data.id),e.onAfterUpdateData(i,t,a.data))return;e.loadData(void 0,t.id),e.$emit("add-row",e.table,a.data,t),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้เพิ่มเรียบร้อยแล้ว")})}else console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)})})).catch((function(t){console.error(t),e.loading=!1,e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}else{var n="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id);if(this.onBeforeUpdateData(n,t))return;this.loading=!0,this.$axios.put(n,this.shallowCopy(t),{params:this.params}).then((function(a){if(e.loading=!1,200===a.status){if(e.onAfterUpdateData(n,t,a.data))return;e.loadData(void 0,t.id),e.$emit("update-row",e.table,a.data,t),e.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(e.table," ได้บันทึกเรียบร้อยแล้ว")})}else console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)})})).catch((function(t){console.error(t),e.loading=!1,e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}this.dialogVisible=!1}}else this.isNewItem?this.$emit("add-row",this.table,t,t):this.$emit("update-row",this.table,t,t)},updateCell:function(t,e){var a=this;if(this.baseUrl&&this.table){if(e&&e.edit){if(!0!==this.validateCell(t[e.name],e,t))return;"number"!==e.edit.type&&"decimal"!==e.edit.type||isNaN(t[e.name])||(t[e.name]=+(t[e.name]||0))}var s="".concat(this.baseUrl,"/").concat(this.table,"/").concat(t.id),i=this.shallowCopy(t);if(!this.onBeforeUpdateData(s,t)){var n=o()({},e.name,t[e.name]);for(var r in i)"object"===l()(t[r])&&null!==t[r]||t[r]===i[r]||(n[r]=t[r]);this.loading=!0,this.$axios.patch(s,this.shallowCopy(n),{params:this.params}).then((function(e){if(a.loading=!1,200===e.status){if(a.onAfterUpdateData(s,t,e.data))return;a.loadData(void 0,t.id),a.$emit("update-cell",a.table,e.data,n),a.$q.notify({type:"positive",message:"ข้อมูลรหัส ".concat(t.id," ใน ").concat(a.table," ได้บันทึกเรียบร้อยแล้ว")})}else console.error("Error ".concat(e.status,": ").concat(e.statusText)),a.$emit("error","Error ".concat(e.status,": ").concat(e.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(e.status,": ").concat(e.statusText)})})).catch((function(t){console.error(t),a.loading=!1,a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}}else this.$emit("update-cell",this.table,t,t)},filterFnAutoSelect:function(t,e,a,s){var i=this;if("string"===typeof t&&" "!==t&&(t=t.replace(/[\\/^$.(){}[\]+*]/g,"").trim()),t&&s){var n="".concat(this.baseUrl,"/").concat(s,"?_sort=id&_order=desc&_limit=10&_expand=*").concat(t?"&name_like="+t:"");this.$axios.get(n,{params:this.params}).then((function(n){200===n.status?e((function(){i.$set(i.filterOptions,s,n.data)}),(function(e){""!==t&&e.options.length>0&&-1===e.optionIndex&&(e.moveOptionSelection(1,!0),e.toggleOption(e.options[e.optionIndex],!0))})):(console.error("Error ".concat(n.status,": ").concat(n.statusText)),i.$emit("error","Error ".concat(n.status,": ").concat(n.statusText)),i.$q.notify({type:"negative",message:"Error ".concat(n.status,": ").concat(n.statusText)}),a())})).catch((function(t){console.error(t),i.$emit("error","Error ".concat(t.message)),i.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}else a()},abortFilterFn:function(){},getCellDisplay:function(t,e){var a;return"number"===e.edit.type||"decimal"===e.edit.type?(a=e.name.endsWith("Id")?(t[e.name.slice(0,-2)]||{}).name||t[e.name]:this.getCellValue(e,t)||0,"decimal"===e.edit.type&&(a=(+a||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits}))):a=this.getCellValue(e,t),0===a&&"NaN"!==a||(a=a||" "),"".concat(e.edit.prefix).concat(a).concat(e.edit.suffix)},bindDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),new Date(t.getTime()-60*t.getTimezoneOffset()*1e3).toISOString().split(".")[0]},eventDateTime:function(t){return t=new Date(t),isNaN(t)&&(t=new Date),t.toISOString()},getCellValue:function(t,e){var a="function"===typeof t.field?t.field(e):e[t.field];return"function"===typeof t.format?t.format(a,e):a},selectOnFocus:function(t){t&&t.target&&"function"===typeof t.target.select&&t.target.select()},validateCell:function(t,e,a){var s=!!e.name.includes(".")||this.onValidateData(t,e,a);return void 0===s&&(s="text"===e.edit.type||"textarea"===e.edit.type||"password"===e.edit.type||"datetime"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0")),s},validateRow:function(t){var e=this,a=function(a){var s=e.columns.find((function(t){return t.name===a}));if(s&&s.edit&&!0!==e.validateCell(t[s.name],s,t))return{v:!1}};for(var s in t){var i=a(s);if("object"===l()(i))return i.v}return!0},deepCompare:function(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)&&("[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((function(a){return this.deepCompare(t[a],e[a])})):t===e)},deepCopy:function(t){if("object"!==l()(t))return t;if(null!==t){var e=Array.isArray(t)?[]:{};for(var a in t)e[a]=this.deepCopy(t[a]);return e}},shallowCopy:function(t){var e=Array.isArray(t)?[]:{};for(var a in t)("object"!==l()(t[a])||Array.isArray(t[a])||null===t[a])&&(a.startsWith("_")||a.includes(".")||(e[a]=t[a]));return e},showDialog:function(){this.dialogVisible=!0},hideDialog:function(){this.dialogVisible=!1},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}},_debug:function(){var t;(t=console).log.apply(t,arguments)}}},p=u,f=(a("a9bc"),a("2877")),m=a("eaac"),g=a("27f9"),h=a("0016"),b=a("05c0"),y=a("9c40"),x=a("bd08"),v=a("357e"),_=a("8f8e"),w=a("24e8"),q=a("f09f"),D=a("a370"),C=a("d847"),$=a("2c91"),I=a("ddd8"),R=a("4b7e"),k=a("db86"),P=a("7cbe"),S=a("eb85"),E=a("3b16"),T=a("75c3"),B=a("7f67"),U=a("eebe"),A=a.n(U),j=Object(f["a"])(p,s,i,!1,null,"294a90be",null);e["a"]=j.exports;A()(j,"components",{QTable:m["a"],QInput:g["a"],QIcon:h["a"],QTooltip:b["a"],QBtn:y["a"],QTr:x["a"],QTh:v["a"],QCheckbox:_["a"],QDialog:w["a"],QCard:q["a"],QCardSection:D["a"],QBar:C["a"],QSpace:$["a"],QSelect:I["a"],QCardActions:R["a"],QTd:k["a"],QPopupProxy:P["a"],QSeparator:S["a"],QPagination:E["a"]}),A()(j,"directives",{TouchPan:T["a"],ClosePopup:B["a"]})},f9ea:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"settingsRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},table:"settings",title:"การตั้งค่า","hide-add-button":"","hide-remove-button":"","hide-pagination":"",classes:t.settings.classes,columns:t.settingColumns},on:{"update-row":t.updateHandler,"update-cell":t.updateHandler}})],1)},i=[],n=(a("caad"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("ec67")),o=a("1732"),r=a("1c16"),l={name:"PageSettings",data:function(){return{settingColumns:[{name:"id",label:"รหัสการตั้งค่า",field:"id",sortable:!0,classes:"hidden",headerClasses:"hidden",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantityPurchase",label:"จำนวนซื้อเริ่มต้น",field:"quantityPurchase",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"quantitySale",label:"จำนวนขายเริ่มต้น",field:"quantitySale",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"profit",label:"กำไร",field:"profit",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatPurchase",label:"ภาษีซื้อ",field:"vatPurchase",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vatSale",label:"ภาษีขาย",field:"vatSale",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"fractionDigits",label:"จุดทศนิยม",field:"fractionDigits",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"classes",label:"Cascading Style Sheets",field:"classes",sortable:!0,classes:"text-green-10",edit:{type:"text",inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}]}},components:{JsonTable:n["a"]},created:function(){var t=this;this.UID=Object(o["a"])(),this.loadDataDebounce=Object(r["a"])((function(e,a){e.loadData(),a&&t.updateHandler("",a)}),500)},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&t.request.path.split("/").includes("settings")&&this.loadDataDebounce(this.$refs.settingsRef,t.response.body)}},methods:{updateHandler:function(t,e){this.$store.dispatch("action",{key:"settings",value:Object.assign({},this.settings,e)})}}},c=l,d=a("2877"),u=Object(d["a"])(c,s,i,!1,null,null,null);e["a"]=u.exports},fbb2:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("JsonTable",{ref:"salesRef",attrs:{"base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:"_expand=customer",table:"sales",title:"รายการขายสินค้า",classes:t.settings.classes,columns:t.saleColumns,onInitAddData:t.onInitAddDataSales,onValidateData:t.onValidateDataSales,onAfterLoadData:t.onAfterLoadDataSales,onBeforeUpdateData:t.onBeforeUpdateDataSales,onBeforeRemoveData:t.onBeforeRemoveDataSales,onAfterRemoveData:t.onAfterRemoveDataSales,selected:t.selectedRows,showSelectRows:""},on:{"update:selected":[function(e){t.selectedRows=e},t.onSelectedRows]}}),a("JsonTable",{ref:"saleProductsRef",attrs:{id:"scrollToThis","base-url":this.$global.data.baseUrl,params:{uid:t.UID},query:t.query,table:"saleProducts",title:t.title,classes:t.settings.classes,columns:t.saleProductColumns,onInitAddData:t.onInitAddData,onInitEditData:t.onInitEditData,onValidateData:t.onValidateData,onBeforeLoadData:t.onBeforeLoadData,onAfterLoadData:t.onAfterLoadData,onBeforeUpdateData:t.onBeforeUpdateData,onAfterUpdateData:t.onAfterUpdateData,onBeforeRemoveData:t.onBeforeRemoveData,onAfterRemoveData:t.onAfterRemoveData,showEditDialog:t.showEditDialog,rowsPerPage:0,hidePagination:""}},[a("template",{slot:"header"},[a("div",{staticClass:"q-pl-md"},[a("q-markup-table",{attrs:{dense:""}},[a("tbody",[a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.saleColumns[5].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s(t.getDecimal((t.selectedRows[0]||{total:0}).total)))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v("บาท")])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.saleColumns[3].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s((t.selectedRows[0]||{discount:0}).discount))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v(t._s(t.saleColumns[3].edit.suffix))])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.saleColumns[4].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px"}},[t._v(t._s((t.selectedRows[0]||{vat:0}).vat))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v(t._s(t.saleColumns[4].edit.suffix))])]),a("tr",[a("td",{staticClass:"text-right"},[t._v(t._s(t.saleColumns[6].label+" :"))]),a("td",{staticClass:"text-right",staticStyle:{"padding-right":"5px","font-weight":"bold"}},[t._v(t._s(t.getDecimal((t.selectedRows[0]||{net:0}).net)))]),a("td",{staticStyle:{"padding-left":"0"}},[t._v("บาท")])])])])],1)])],2),a("q-page-sticky",{attrs:{position:"top-right",offset:[0,0]}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{"fab-mini":"",glossy:"",round:"",icon:"print",color:"accent",size:"xs",disable:t.selectedRows<=0||t.selectedRows[0].net<=0},on:{click:function(){return t.printData()}}})],1),a("div",{staticClass:"q-pa-none fit row wrap justify-center items-center content-start",attrs:{id:"print"}},[t.selectedRows.length>0?a("div",{staticClass:"q-pa-md row wrap justify-center items-start content-start",staticStyle:{width:"331px",border:"1px solid black"},attrs:{id:"printBorder"}},[a("div",{staticClass:"q-pa-none text-bold",staticStyle:{width:"297px"}},[a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("img",{attrs:{src:"logo.png",width:"150"}}),(t.settings||{}).address?a("div",[t._v("\n            "+t._s((t.settings||{}).address)+"\n          ")]):t._e(),(t.settings||{}).telephone?a("div",[t._v("\n            โทรศัพท์: "+t._s((t.settings||{}).telephone)+"\n          ")]):t._e(),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"text-h6",staticStyle:{"text-decoration":"underline"}},[t._v("\n            บิลส่งสินค้า\n          ")]),t.selectedRows.length>0&&t.selectedRows[0].date?a("div",{attrs:{align:"center"}},[t._v("\n            วันที่: "+t._s(new Date(t.selectedRows[0].date).toLocaleString())+"\n          ")]):t._e()]),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"q-pa-none"},[t._m(0),t._l((t.$refs.saleProductsRef||{}).data,(function(e){return a("div",{key:e.id,staticClass:"row"},[a("div",{staticClass:"col-1 text-center"},[t._v(t._s(e.quantity))]),a("div",{staticClass:"col"},[t._v(t._s(e.product.name))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.price||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),a("div",{staticClass:"col-3 text-right"},[t._v(t._s((+e.total||0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))])])}))],2),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"q-pa-none"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-auto"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("รวม:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.saleProductsRef||{}).data||[]).reduce((function(t,e){return t+e.quantity}),0)))]),a("div",{staticClass:"col"},[t._v(" ชิ้น")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col text-right"},[t._v("จาก:")]),a("div",{staticClass:"col text-right"},[t._v(" "+t._s(((t.$refs.saleProductsRef||{}).data||[]).length))]),a("div",{staticClass:"col"},[t._v(" รายการ")])])]),a("div",{staticClass:"col"},[a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?t.selectedRows[0].total:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ส่วนลด:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?t.selectedRows[0].total*t.selectedRows[0].discount/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ภาษี:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0?(t.selectedRows[0].total-t.selectedRows[0].total*t.selectedRows[0].discount/100)*t.selectedRows[0].vat/100:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("รวมสุทธิ:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "),a("span",{staticStyle:{"text-decoration":"underline"}},[t._v(t._s((+t.selectedRows.length>0?t.selectedRows[0].net:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits})))]),t._v(" บาท")])]),a("div",{staticClass:"q-pa-sm"}),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ชำระเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0&&t.selectedRows[0].cash?t.selectedRows[0].cash:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])]),a("div",{staticClass:"row justify-between"},[a("div",{staticClass:"col-5 text-right"},[t._v("ทอนเงิน:")]),a("div",{staticClass:"col-7 text-right"},[t._v(" "+t._s((+t.selectedRows.length>0&&t.selectedRows[0].cash?t.selectedRows[0].cash-t.selectedRows[0].net:0).toLocaleString(void 0,{minimumFractionDigits:t.settings.fractionDigits,maximumFractionDigits:t.settings.fractionDigits}))+" บาท")])])])])]),a("div",{staticClass:"q-pa-sm"}),t._m(1)])]):t._e()]),a("q-dialog",{attrs:{persistent:""},model:{value:t.cashDialog,callback:function(e){t.cashDialog=e},expression:"cashDialog"}},[a("q-card",{style:t.dialogStyle},[a("q-card-section",{staticClass:"q-pa-none",staticStyle:{cursor:"grab","min-width":"500px"}},[a("q-bar",{directives:[{name:"touch-pan",rawName:"v-touch-pan.mouse",value:t.onPanDialog,expression:"onPanDialog",modifiers:{mouse:!0}}],staticClass:"bg-primary text-white"},[a("div",[t._v(t._s(t.title))]),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{dense:"",flat:"",icon:"close"}})],1)],1),a("q-card-section",[a("div",{staticClass:"q-pa-md"},[a("q-input",{staticClass:"no-spin-button",attrs:{type:"number",autofocus:"",counter:"",debounce:"500",label:"ชำระเงิน","input-class":"text-right text-h3",rules:[function(t){return t>=0||"ข้อมูลต้องมีค่ามากกว่าหรือเท่ากับ 0"}]},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),function(){return t.cashValue>0&&t.selectedRows.length>0&&t.updateCash(t.selectedRows[0])}())},focus:function(t){return t&&t.target&&"function"===typeof t.target.select&&t.target.select()}},model:{value:t.cashValue,callback:function(e){t.cashValue=t._n(e)},expression:"cashValue"}}),a("q-input",{attrs:{value:(+t.selectedRows.length>0?t.selectedRows[0].net:0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ราคาสุทธิ","input-class":"text-right text-h3"}}),a("q-input",{attrs:{value:(+t.selectedRows.length>0&&t.cashValue>t.selectedRows[0].net?t.cashValue-t.selectedRows[0].net:0).toFixed(this.settings.fractionDigits),type:"text",readonly:"",label:"ทอนเงิน","input-class":"text-right text-h3"}})],1)]),a("q-card-section",[a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{glossy:"",color:"grey",label:"1000"},on:{click:function(e,a){return t.cashValueThrottle(1e3)}}}),a("q-btn",{attrs:{glossy:"",color:"purple",label:"500"},on:{click:function(e,a){return t.cashValueThrottle(500)}}}),a("q-btn",{attrs:{glossy:"",color:"red",label:"100"},on:{click:function(e,a){return t.cashValueThrottle(100)}}}),a("q-btn",{attrs:{glossy:"",color:"blue",label:"50"},on:{click:function(e,a){return t.cashValueThrottle(50)}}}),a("q-btn",{attrs:{glossy:"",color:"green",label:"20"},on:{click:function(e,a){return t.cashValueThrottle(20)}}})],1),a("q-separator"),a("div",{staticClass:"q-pa-md q-gutter-md row justify-between"},[a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-10",label:"10"},on:{click:function(e,a){return t.cashValueThrottle(10)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-9",label:"5"},on:{click:function(e,a){return t.cashValueThrottle(5)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-8",label:"2"},on:{click:function(e,a){return t.cashValueThrottle(2)}}}),a("q-btn",{attrs:{round:"",glossy:"",color:"yellow-7",label:"1"},on:{click:function(e,a){return t.cashValueThrottle(1)}}})],1),a("q-separator")],1),a("q-card-actions",{staticClass:"q-pa-md",attrs:{align:"evenly"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"primary",label:"ย้อนกลับไป"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"secondary",label:"รับเงิน ไม่พิมพ์",disable:t.cashValue<=0||t.cashValue<(t.selectedRows.length>0?t.selectedRows[0].net:0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRows.length>0&&t.updateCash(t.selectedRows[0],!1)}}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{color:"positive",label:"รับเงิน และพิมพ์",disable:t.cashValue<=0||t.cashValue<(t.selectedRows.length>0?t.selectedRows[0].net:0)},on:{click:function(e,a){return t.cashValue>0&&t.selectedRows.length>0&&t.updateCash(t.selectedRows[0])}}})],1)],1)],1)],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"text-decoration":"underline"}},[a("div",{staticClass:"col-1"},[t._v("จำนวน")]),a("div",{staticClass:"col text-center"},[t._v("รายการ")]),a("div",{staticClass:"col-3 text-right"},[t._v("หน่วย")]),a("div",{staticClass:"col-3 text-right"},[t._v("รวม")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-none",attrs:{align:"center"}},[a("div",{staticClass:"text-h6"},[t._v("\n            ขอบคุณที่ใช้บริการ\n          ")])])}],n=(a("99af"),a("7db0"),a("4160"),a("caad"),a("13d5"),a("b0c0"),a("b680"),a("cca6"),a("ac1f"),a("2532"),a("1276"),a("498a"),a("159b"),a("7037")),o=a.n(n),r=a("ec67"),l=a("1732"),c=a("1c16"),d=a("e302"),u={name:"PageSales",data:function(){return{saleColumns:[{name:"id",label:"รหัสขายสินค้า",field:"id",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"date",label:"วัน/เดือน/ปี เวลา",field:"date",format:function(t,e){return"".concat(new Date(t).toLocaleString())},sortable:!0,classes:"text-green-10",edit:{type:"datetime",inputClass:"",prefix:"",suffix:""}},{name:"customerId",label:"ลูกค้า",field:"customerId",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"vat",label:"ภาษี",field:"vat",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"total",label:"รวม",field:"total",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"net",label:"รวมสุทธิ",field:"net",sortable:!0,headerClasses:"text-weight-bold",classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"cash",label:"ชำระเงิน",field:"cash",sortable:!0,classes:"text-green-10",edit:{type:"decimal",inputClass:"",prefix:"",suffix:""}},{name:"change",label:"ทอนเงิน",field:function(t){return t.cash?t.cash-t.net:0},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],saleProductColumns:[{name:"product.id",label:"รหัสสินค้า",field:function(t){return t.product.id},sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.type.name",label:"ประเภทสินค้า",field:function(t){return(t.product.type||{name:void 0}).name},sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.unit.name",label:"หน่วยนับ",field:function(t){return(t.product.unit||{name:void 0}).name},sortable:!0,edit:{type:"text",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"productId",label:"ชื่อสินค้า",field:"productId",sortable:!0,edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"quantity",label:"จำนวน",field:"quantity",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:""}},{name:"product.cost",label:"ราคาทุน",field:function(t){return t.product.cost},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.price",label:"ราคาขาย",field:function(t){return t.product.price},sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"discount",label:"ส่วนลด",field:"discount",sortable:!0,classes:"text-green-10",edit:{type:"number",inputClass:"",prefix:"",suffix:"%"}},{name:"price",label:"ราคา",field:"price",sortable:!0,edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"total",label:"ราคารวม",field:"total",sortable:!0,classes:"text-weight-bold",edit:{type:"decimal",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"product.quantity",label:"คงเหลือ",field:function(t){return t.product.quantity},sortable:!0,classes:"text-weight-bold",edit:{type:"number",readonly:!0,inputClass:"",prefix:"",suffix:""}},{name:"actions",label:"ดำเนินการ",field:"actions",sortable:!1,edit:{type:"actions",inputClass:"",prefix:"",suffix:""}}],saleId:void 0,query:"_expand=product&_expand=type&_expand=unit&saleId=".concat(this.saleId),title:"ขายสินค้า",selectedRows:[],firstRow:{},showEditDialog:!1,cashDialog:!1,cashValue:0,dialogPos:{x:0,y:0}}},components:{JsonTable:r["a"]},created:function(){var t=this;this.UID=Object(l["a"])(),this.loadDataDebounce=Object(c["a"])((function(t){t.loadData()}),500),this.cashValueThrottle=Object(d["a"])((function(e){t.cashValue+=e}),500)},computed:{settings:{get:function(){return this.$root.$store.state.data.settings||{}}},dialogStyle:function(){return{transform:"translate(".concat(this.dialogPos.x,"px, ").concat(this.dialogPos.y,"px)")}}},watch:{"$global.data.qualify":function(t,e){t.request&&t.request.query&&t.request.query.uid!==this.UID&&(t.request.path.split("/").includes("sales")?this.loadDataDebounce(this.$refs.salesRef):t.request.path.split("/").includes("saleProducts")&&this.loadDataDebounce(this.$refs.saleProductsRef))}},mounted:function(){void 0===this._keyListener.timeStamp&&(this._keyListener.timeStamp=0,window.addEventListener("keydown",this._keyListener))},beforeDestroy:function(){void 0!==this._keyListener.timeStamp&&window.removeEventListener("keydown",this._keyListener)},methods:{onInitAddDataSales:function(t){t.date=(new Date).toISOString(),t.vat=this.settings.vatSale,t.customerId=this.firstRow.customerId||0,t.customer=this.firstRow.customer},onValidateDataSales:function(t,e){return"customerId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลลูกค้า":"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onAfterLoadDataSales:function(t,e){var a=this;this.$axios.get("".concat(this.$global.data.baseUrl,"/sales?_page=1&_sort=id&_order=asc&_limit=1&_expand=customer"),{params:{uid:this.UID}}).then((function(t){200===t.status?t.data.length>0?a.firstRow={customerId:t.data[0].customerId,customer:t.data[0].customer}:a.$axios.get("".concat(a.$global.data.baseUrl,"/customers?_page=1&_sort=id&_order=asc&_limit=1"),{params:{uid:a.UID}}).then((function(t){200===t.status?a.firstRow=t.data.length>0?{customerId:t.data[0].id,customer:t.data[0]}:{}:(console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}),a.firstRow={})})).catch((function(t){console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}),a.firstRow={}})):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}),a.firstRow={})})).catch((function(t){console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)}),a.firstRow={}}))},onBeforeUpdateDataSales:function(t,e){e.id||(e.date=(new Date).toISOString()),e.net=e.total-e.total*e.discount/100,e.net=e.net+e.net*e.vat/100,e.net=+e.net.toFixed(this.settings.fractionDigits)},onBeforeRemoveDataSales:function(t,e){console.log("Event onBeforeRemoveDataSales")},onAfterRemoveDataSales:function(t,e,a){var s=this;a&&a.__deleted__&&a.__deleted__.saleProducts&&a.__deleted__.saleProducts.forEach((function(t){s.updateProduct({productId:t.productId,quantity:0,__:{quantity:t.quantity}})}))},onSelectedRows:function(t){this.selectedRows.length>0?(this.saleId=+this.selectedRows[0].id,this.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(this.saleId),this.title="ขายสินค้า ".concat((this.selectedRows[0].customer||{}).name," [").concat(this.saleId,"] (").concat(new Date(this.selectedRows[0].date).toLocaleString(),")"),this.$global.scrollToElement("scrollToThis",1e3,1e3)):(this.saleId=void 0,this.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(this.saleId),this.title="ขายสินค้า",document.activeElement.blur())},onInitAddData:function(t){if(!this.saleId)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t),t.quantity=this.settings.quantitySale},onInitEditData:function(t){if(!this.saleId)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;this.initialData(t)},onValidateData:function(t,e,a){return"productId"===e.name&&t<=0?"ยังไม่ได้กำหนดข้อมูลสินค้า":"quantity"===e.name?t<=0?"จำนวนสินค้าต้องมีค่ามากกว่า 0":!(a.product.quantity-(t-a.__.quantity)<=0)||(a.product.quantity<=0?(this.$q.notify({type:"warning",icon:"report_problem",position:"top",caption:"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name),message:"สินค้า: ".concat(a.product.name," (สินค้าหมด)"),multiLine:!0,progress:!0,timeout:1e4,actions:[{label:"ตกลง",color:"white",handler:function(){}}]}),"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name)):(this.$q.notify({type:"negative",icon:"report_problem",position:"top",caption:"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name),message:"สินค้า: ".concat(a.product.name," (ไม่เพียงพอ)"),multiLine:!0,progress:!0,timeout:1e4,actions:[{label:"ตกลง",color:"white",handler:function(){}}]}),"คงเหลือ: ".concat(a.product.quantity," ").concat(a.product.unit.name))):"text"===e.edit.type||"textarea"===e.edit.type||"date"===e.edit.type?!!t||"ยังไม่ได้กำหนดข้อมูล":"number"!==e.edit.type&&"decimal"!==e.edit.type||(t>=0||"ยังไม่ได้กำหนดข้อมูล")},onBeforeLoadData:function(t,e){var a=this;e.forEach((function(t){return a.initialData(t)}))},onAfterLoadData:function(t,e){document.activeElement.blur()},onBeforeUpdateData:function(t,e){e.saleId||(e.saleId=this.saleId),e.product&&(e["product.id"]=e.product.id,e["product.type.name"]=(e.product.type||{name:""}).name,e["product.unit.name"]=(e.product.unit||{name:""}).name,e["product.cost"]=e.product.cost,e["product.price"]=e.product.price,e["product.quantity"]=e.product.quantity),e.price=+(e["product.price"]-e["product.price"]*e.discount/100).toFixed(this.settings.fractionDigits),e.total=+(e.quantity*e.price).toFixed(this.settings.fractionDigits)},onAfterUpdateData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},onBeforeRemoveData:function(t,e){e.__.quantity=e.quantity,e.quantity=0},onAfterRemoveData:function(t,e,a){this.updateTotal(e),this.updateProduct(e)},initialData:function(t){t.saleId||(t.saleId=this.saleId),t.__=Object.assign({},t.__,{quantity:t.quantity})},updateTotal:function(t){var e=this;this.$axios.get("".concat(this.$global.data.baseUrl,"/saleProducts?saleId=").concat(this.saleId),{params:{uid:this.UID}}).then((function(a){if(200===a.status)if(e.selectedRows.length>0){var s={total:+a.data.reduce((function(t,e){return t+e.total}),0).toFixed(e.settings.fractionDigits)};s.net=s.total-s.total*e.selectedRows[0].discount/100,s.net=s.net+s.net*e.selectedRows[0].vat/100,s.net=+s.net.toFixed(e.settings.fractionDigits),e.$axios.patch("".concat(e.$global.data.baseUrl,"/sales/").concat(e.saleId),s,{params:{uid:e.UID}}).then((function(a){200===a.status?(e.selectedRows[0].total=a.data.total,e.selectedRows[0].net=a.data.net,t.__.quantity=t.quantity,e.$emit("update-cell","sales",a.data,s)):(console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)}))})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))}else e.saleId=void 0,e.query="_expand=product&_expand=type&_expand=unit&saleId=".concat(e.saleId),e.title="ขายสินค้า";else console.error("Error ".concat(a.status,": ").concat(a.statusText)),e.$emit("error","Error ".concat(a.status,": ").concat(a.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(a.status,": ").concat(a.statusText)})})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},updateProduct:function(t){var e=this,a={id:t.productId,quantityDelta:+t.__.quantity-+t.quantity};this.$axios.patch("".concat(this.$global.data.baseUrl,"/products/").concat(t.productId),a,{params:{uid:this.UID}}).then((function(s){200===s.status?(t.product=Object.assign({},s.data),e.$emit("update-cell","products",s.data,a)):(console.error("Error ".concat(s.status,": ").concat(s.statusText)),e.$emit("error","Error ".concat(s.status,": ").concat(s.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(s.status,": ").concat(s.statusText)}))})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},updateCash:function(t){var e=this,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.cashDialog=!1,t.cash=this.cashValue;var s={id:t.id,cash:t.cash};this.$axios.patch("".concat(this.$global.data.baseUrl,"/sales/").concat(t.id),s,{params:{uid:this.UID}}).then((function(t){200===t.status?(a&&(e.printBorderVisibility(!1),e.$global.print("#print",e.settings.name,(function(){return e.printBorderVisibility(!0)}))),e.$emit("update-cell","sales",t.data,s)):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),e.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),e.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}))})).catch((function(t){console.error(t),e.$emit("error","Error ".concat(t.message)),e.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},getDecimal:function(t){return(+t||0).toLocaleString(void 0,{minimumFractionDigits:this.settings.fractionDigits,maximumFractionDigits:this.settings.fractionDigits})},printData:function(){var t=this;this.selectedRows.length>0&&(this.selectedRows[0].cash?(this.printBorderVisibility(!1),this.$global.print("#print",this.settings.name,(function(){return t.printBorderVisibility(!0)}))):(this.cashDialog=!0,this.cashValue=0))},findProductBarcode:function(t){var e=this;if(!this.saleId)return this.$q.notify({type:"warning",html:!0,message:"ยังไม่ได้เลือกรายการขายสินค้า"}),this.showEditDialog=!1,!0;this.getProductBarcode(t,(function(t){if(e.selectedRows.length>0&&"object"===o()(t)&&Array.isArray(t)&&t.length>0){var a,s=e.$refs.saleProductsRef.$data.data.find((function(e){return e.productId===t[0].id}));s?(a=e.$refs.saleProductsRef.editItem(!1),a.__.quantity=s.quantity,a.id=s.id,a.discount=s.discount,a.quantity=s.quantity+e.settings.quantitySale):(a=e.$refs.saleProductsRef.addItem(!1),a.__.quantity=0),a.product=t[0],a.productId=a.product.id,e.$refs.saleProductsRef.updateRow(a)}}))},_keyListener:function(t){if(t.timeStamp-(this._keyListener.timeStamp||0)>1e3)"Enter"===t.key?this._keyListener.text="":this._keyListener.text=t.key;else{if("Enter"===t.key){t.preventDefault(),t.stopPropagation();var e=this._keyListener.text.trim();return this._keyListener.text="",e&&this.findProductBarcode(e),!1}this._keyListener.text+=t.key}this._keyListener.timeStamp=t.timeStamp},getProductBarcode:function(t,e){var a=this;this.$axios.get("".concat(this.$global.data.baseUrl,"/products/?_expand=type&_expand=unit&barcode=").concat(t),{params:{uid:this.UID}}).then((function(t){200===t.status?"function"===typeof e&&e(t.data):(console.error("Error ".concat(t.status,": ").concat(t.statusText)),a.$emit("error","Error ".concat(t.status,": ").concat(t.statusText)),a.$q.notify({type:"negative",message:"Error ".concat(t.status,": ").concat(t.statusText)}))})).catch((function(t){console.error(t),a.$emit("error","Error ".concat(t.message)),a.$q.notify({type:"negative",message:"Error ".concat(t.message)})}))},printBorderVisibility:function(t){document.getElementById("printBorder").style.borderColor=t?"black":"transparent"},onPanDialog:function(t){this.dialogPos={x:this.dialogPos.x+t.delta.x,y:this.dialogPos.y+t.delta.y}}}},p=u,f=(a("8cea"),a("2877")),m=a("2bb1"),g=a("de5e"),h=a("9c40"),b=a("24e8"),y=a("f09f"),x=a("a370"),v=a("d847"),_=a("2c91"),w=a("27f9"),q=a("eb85"),D=a("4b7e"),C=a("75c3"),$=a("7f67"),I=a("eebe"),R=a.n(I),k=Object(f["a"])(p,s,i,!1,null,"910d8836",null);e["a"]=k.exports;R()(k,"components",{QMarkupTable:m["a"],QPageSticky:g["a"],QBtn:h["a"],QDialog:b["a"],QCard:y["a"],QCardSection:x["a"],QBar:v["a"],QSpace:_["a"],QInput:w["a"],QSeparator:q["a"],QCardActions:D["a"]}),R()(k,"directives",{TouchPan:C["a"],ClosePopup:$["a"]})}}]);